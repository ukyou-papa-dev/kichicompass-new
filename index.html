<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KichiCompass - あなただけの運命の羅針盤</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Hiragino Sans', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: white;
        }
        
        .countdown {
            position: fixed;
            top: 0;
            width: 100%;
            background: linear-gradient(90deg, #ff0000, #ff6600);
            padding: 12px;
            text-align: center;
            font-weight: bold;
            z-index: 1000;
            animation: flash 1s infinite;
        }
        
        @keyframes flash {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 80px 20px 40px;
        }
        
        h1 {
            font-size: 3em;
            text-align: center;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .visitor-count {
            text-align: center;
            margin: 20px 0;
        }
        
        .visitor-badge {
            display: inline-block;
            background: rgba(0,0,0,0.5);
            padding: 10px 25px;
            border-radius: 25px;
            color: #00ff00;
            font-family: monospace;
            font-size: 18px;
        }
        
        .fortune-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
            margin: 40px 0;
        }
        
        .fortune-card {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            backdrop-filter: blur(10px);
        }
        
        .fortune-card:hover {
            transform: translateY(-10px) scale(1.05);
            background: rgba(255,255,255,0.2);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        
        .fortune-card h3 {
            font-size: 1.5em;
            margin-bottom: 10px;
        }
        
        .cta-button {
            display: inline-block;
            background: linear-gradient(45deg, #FFD700, #FFA500);
            color: white;
            padding: 18px 50px;
            border-radius: 50px;
            text-decoration: none;
            font-weight: bold;
            font-size: 1.3em;
            margin: 20px;
            animation: pulse 2s infinite;
            box-shadow: 0 5px 20px rgba(255,215,0,0.5);
            border: none;
            cursor: pointer;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255,215,0,0.7); }
            50% { transform: scale(1.05); box-shadow: 0 0 0 20px rgba(255,215,0,0); }
            100% { transform: scale(1); }
        }
        
        .popup {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: white;
            color: #333;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
            animation: slideIn 0.5s;
            z-index: 999;
        }
        
        @keyframes slideIn {
            from { transform: translateX(-150%); }
            to { transform: translateX(0); }
        }
        
        #form-section, #result-section {
            display: none;
            text-align: center;
            padding: 40px;
        }
        
        input {
            width: 100%;
            max-width: 400px;
            padding: 15px;
            margin: 10px auto;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            display: block;
        }
    </style>
</head>
<body>
    <div class="countdown" id="countdown">
        ⚠️ 初回87%OFF終了まで: 計算中...
    </div>
    
    <div class="container">
        <h1>🔮 KichiCompass 🔮</h1>
        <p style="text-align:center;font-size:1.2em;">あなただけの運命の羅針盤</p>
        
        <div class="visitor-count">
            <div class="visitor-badge" id="visitors">
                🔴 現在523名が鑑定中
            </div>
        </div>
        
        <div class="fortune-grid">
            <div class="fortune-card" onclick="startFortune('astrology')">
                <h3>⭐ 西洋占星術</h3>
                <p>12星座が導く運命</p>
            </div>
            <div class="fortune-card" onclick="startFortune('tarot')">
                <h3>🎴 タロット占い</h3>
                <p>78枚が示す真実</p>
            </div>
            <div class="fortune-card" onclick="startFortune('shichu')">
                <h3>🐉 四柱推命</h3>
                <p>東洋最高の的中率</p>
            </div>
            <div class="fortune-card" onclick="startFortune('numerology')">
                <h3>🔢 数秘術</h3>
                <p>数字が導く使命</p>
            </div>
        </div>
        
        <div style="text-align:center;">
            <button class="cta-button" onclick="startFortune()">
                無料で今すぐ占う
            </button>
        </div>
        
        <div id="form-section">
            <h2>あなたの情報を入力</h2>
            <input type="text" id="name" placeholder="お名前" required>
            <input type="date" id="birthdate" required>
            <input type="email" id="email" placeholder="メールアドレス">
            <button class="cta-button" onclick="showResult()">
                運命を見る
            </button>
        </div>
        
        <div id="result-section">
            <h2 id="result-name">結果</h2>
            <div style="background:rgba(255,255,255,0.1);padding:30px;border-radius:15px;margin:20px 0;">
                <p id="result-text"></p>
            </div>
            <div style="filter:blur(5px);background:rgba(255,255,255,0.05);padding:30px;border-radius:15px;position:relative;">
                <p>さらに詳しい内容が...</p>
                <div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(0,0,0,0.9);padding:20px;border-radius:10px;">
                    <p style="color:gold;font-size:1.2em;">💫 完全版を解放 💫</p>
                    <a href="https://buy.stripe.com/test_https://buy.stripe.com/test_aFa7sK5bP99E2pF8BUcV200" class="cta-button">
                        今だけ480円
                    </a>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // カウントダウン
        setInterval(() => {
            const now = new Date();
            const tonight = new Date();
            tonight.setHours(23, 59, 59);
            const diff = tonight - now;
            const h = Math.floor(diff / 3600000);
            const m = Math.floor((diff % 3600000) / 60000);
            const s = Math.floor((diff % 60000) / 1000);
            document.getElementById('countdown').textContent = 
                `⚠️ 初回87%OFF終了まで: ${h}時間${m}分${s}秒`;
        }, 1000);
        
        // 訪問者数
        setInterval(() => {
            const count = 500 + Math.floor(Math.random() * 150);
            document.getElementById('visitors').textContent = 
                `🔴 現在${count}名が鑑定中`;
        }, 3000);
        
        // ポップアップ
        setInterval(() => {
            const messages = [
                '東京都のA様が申し込みました',
                '大阪府のK様が有料プランに登録',
                '福岡県のM様が占いを完了'
            ];
            const popup = document.createElement('div');
            popup.className = 'popup';
            popup.textContent = messages[Math.floor(Math.random() * messages.length)];
            document.body.appendChild(popup);
            setTimeout(() => popup.remove(), 4000);
        }, 8000);
        
        // 占い開始
        function startFortune(type) {
            document.getElementById('form-section').style.display = 'block';
            if(type) localStorage.setItem('fortuneType', type);
        }
        
        // 結果表示
        function showResult() {
            const name = document.getElementById('name').value || 'あなた';
            document.getElementById('result-section').style.display = 'block';
            document.getElementById('result-name').textContent = `${name}様の運命`;
            document.getElementById('result-text').innerHTML = `
                ${name}様、驚くべきことに、あなたには特別な才能が眠っています。<br><br>
                近い将来、人生を変える重要な出会いが訪れるでしょう。<br><br>
                しかし、注意すべき時期があり...
            `;
            document.getElementById('form-section').style.display = 'none';
        }
    </script>
</body>
</html>
<!-- 既存のコードの<script>タグ内に以下を追加 -->
<script>
// 既存のコードの後に追加

// ページ読み込み時に実行
window.addEventListener('load', function() {
    // 初回訪問メッセージ
    setTimeout(() => {
        const welcome = document.createElement('div');
        welcome.style.cssText = `
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            z-index: 10000;
            box-shadow: 0 10px 50px rgba(0,0,0,0.5);
            animation: fadeIn 0.5s;
        `;
        welcome.innerHTML = `
            <h2 style="margin-bottom:15px;">🌟 特別なお知らせ 🌟</h2>
            <p style="margin-bottom:20px;">あなたは選ばれし${Math.floor(Math.random() * 100) + 1}人目の訪問者です！</p>
            <p style="color:#FFD700;font-size:1.2em;margin-bottom:20px;">今だけ初回87%OFF</p>
            <button onclick="this.parentElement.remove()" style="
                background: linear-gradient(45deg, #FFD700, #FFA500);
                color: white;
                border: none;
                padding: 12px 30px;
                border-radius: 25px;
                font-size: 16px;
                cursor: pointer;
                font-weight: bold;
            ">特別価格で始める</button>
        `;
        document.body.appendChild(welcome);
    }, 2000);

    // 離脱防止強化
    let exitIntent = false;
    document.addEventListener('mouseout', function(e) {
        if (e.clientY < 10 && !exitIntent) {
            exitIntent = true;
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0,0,0,0.8);
                z-index: 10000;
                display: flex;
                align-items: center;
                justify-content: center;
            `;
            modal.innerHTML = `
                <div style="background:white;padding:40px;border-radius:20px;text-align:center;max-width:400px;">
                    <h2 style="color:#ff0000;margin-bottom:20px;">⚠️ ちょっと待って！</h2>
                    <p style="color:#333;margin-bottom:20px;">今なら特別に<br><span style="font-size:2em;color:#ff0000;">90%OFF</span><br>でご提供します！</p>
                    <p style="color:#666;margin-bottom:20px;">このチャンスは二度とありません</p>
                    <button onclick="this.parentElement.parentElement.remove()" style="
                        background: linear-gradient(45deg, #ff0000, #ff6600);
                        color: white;
                        border: none;
                        padding: 15px 40px;
                        border-radius: 30px;
                        font-size: 18px;
                        cursor: pointer;
                        font-weight: bold;
                        animation: pulse 1s infinite;
                    ">今すぐ90%OFFで始める</button>
                </div>
            `;
            document.body.appendChild(modal);
        }
    });
});

// スクロール誘導
document.querySelectorAll('.fortune-card').forEach(card => {
    card.addEventListener('click', function() {
        // カード選択時のエフェクト
        this.style.transform = 'scale(0.95)';
        setTimeout(() => {
            this.style.transform = '';
        }, 200);
    });
});
</script>
<!-- </body>タグの直前に追加 -->
<script>
// 占いロジック本体
const fortuneTelling = {
    // 西洋占星術
    astrology: function(name, birthdate) {
        const date = new Date(birthdate);
        const month = date.getMonth() + 1;
        const day = date.getDate();
        
        let zodiac = '';
        if ((month == 3 && day >= 21) || (month == 4 && day <= 19)) zodiac = '牡羊座';
        else if ((month == 4 && day >= 20) || (month == 5 && day <= 20)) zodiac = '牡牛座';
        else if ((month == 5 && day >= 21) || (month == 6 && day <= 20)) zodiac = '双子座';
        else if ((month == 6 && day >= 21) || (month == 7 && day <= 22)) zodiac = '蟹座';
        else if ((month == 7 && day >= 23) || (month == 8 && day <= 22)) zodiac = '獅子座';
        else if ((month == 8 && day >= 23) || (month == 9 && day <= 22)) zodiac = '乙女座';
        else if ((month == 9 && day >= 23) || (month == 10 && day <= 22)) zodiac = '天秤座';
        else if ((month == 10 && day >= 23) || (month == 11 && day <= 21)) zodiac = '蠍座';
        else if ((month == 11 && day >= 22) || (month == 12 && day <= 21)) zodiac = '射手座';
        else if ((month == 12 && day >= 22) || (month == 1 && day <= 19)) zodiac = '山羊座';
        else if ((month == 1 && day >= 20) || (month == 2 && day <= 18)) zodiac = '水瓶座';
        else zodiac = '魚座';
        
        return `
            <h3>${name}様は${zodiac}です</h3>
            <div style="background:rgba(255,255,255,0.1);padding:20px;border-radius:10px;margin:20px 0;">
                <h4>🌟 恋愛運</h4>
                <p>${name}様の恋愛運は今、特別な転機を迎えています。${zodiac}の持つ魅力が最大限に発揮される時期です。</p>
                <p>特に今月の15日前後は重要な出会いの可能性が...</p>
            </div>
            <div style="filter:blur(3px);background:rgba(255,255,255,0.05);padding:20px;border-radius:10px;position:relative;">
                <p>しかし、${name}様には注意すべき時期があります。特に...</p>
                <p>金運では驚くべき変化が...</p>
                <p>健康面では${zodiac}特有の...</p>
                <div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(0,0,0,0.95);padding:20px;border-radius:10px;text-align:center;">
                    <p style="color:gold;font-size:1.2em;">💫 詳細を解放 💫</p>
                    <p style="color:white;">この先の重要な情報を見る</p>
                    <a href="https://buy.stripe.com/test_あなたのURL" class="cta-button" style="margin-top:10px;">
                        今だけ480円
                    </a>
                </div>
            </div>
        `;
    },
    
    // タロット
    tarot: function(name) {
        const cards = [
            '愚者：新しい始まり、無限の可能性',
            '魔術師：創造力、実現力',
            '女教皇：直感、内なる声',
            '女帝：豊穣、母性',
            '皇帝：権威、安定',
            '教皇：伝統、精神性',
            '恋人：選択、調和',
            '戦車：勝利、意志力',
            '力：内なる強さ、忍耐',
            '隠者：内省、真理の探求'
        ];
        
        const past = cards[Math.floor(Math.random() * cards.length)];
        const present = cards[Math.floor(Math.random() * cards.length)];
        const future = cards[Math.floor(Math.random() * cards.length)];
        
        return `
            <h3>${name}様のタロット占い結果</h3>
            <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:20px;margin:20px 0;">
                <div style="background:rgba(255,255,255,0.1);padding:15px;border-radius:10px;">
                    <h4>過去</h4>
                    <p>${past}</p>
                </div>
                <div style="background:rgba(255,255,255,0.1);padding:15px;border-radius:10px;">
                    <h4>現在</h4>
                    <p>${present}</p>
                </div>
                <div style="background:rgba(255,255,255,0.1);padding:15px;border-radius:10px;">
                    <h4>未来</h4>
                    <p>${future}</p>
                </div>
            </div>
            <div style="filter:blur(3px);padding:20px;position:relative;">
                <p>カードが示す${name}様の本当の運命は...</p>
                <div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(0,0,0,0.95);padding:20px;border-radius:10px;">
                    <a href="https://buy.stripe.com/test_あなたのURL" class="cta-button">
                        完全解釈を見る
                    </a>
                </div>
            </div>
        `;
    }
};

// 占い結果を表示する関数を修正
function showResult() {
    const name = document.getElementById('name').value || 'あなた';
    const birthdate = document.getElementById('birthdate').value;
    const fortuneType = localStorage.getItem('fortuneType') || 'astrology';
    
    let resultHTML = '';
    
    switch(fortuneType) {
        case 'astrology':
            resultHTML = fortuneTelling.astrology(name, birthdate);
            break;
        case 'tarot':
            resultHTML = fortuneTelling.tarot(name);
            break;
        default:
            resultHTML = fortuneTelling.astrology(name, birthdate);
    }
    
    document.getElementById('result-section').style.display = 'block';
    document.getElementById('result-section').innerHTML = `
        <div style="max-width:800px;margin:0 auto;padding:20px;">
            ${resultHTML}
        </div>
    `;
    
    document.getElementById('form-section').style.display = 'none';
    
    // 結果を保存
    const results = JSON.parse(localStorage.getItem('fortuneResults') || '[]');
    results.push({
        name: name,
        type: fortuneType,
        date: new Date().toISOString()
    });
    localStorage.setItem('fortuneResults', JSON.stringify(results));
}
</script>
