<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã€å½“ãŸã‚‹ã€‘ç„¡æ–™å ã„ KichiCompass | æ‹æ„›ãƒ»ä»•äº‹ãƒ»é‡‘é‹ 2024å¹´æœ€æ–°</title>
    <meta name="description" content="é©šç•°ã®çš„ä¸­ç‡98.7%ï¼æ‹æ„›ã€ä»•äº‹ã€é‡‘é‹ã‚’ç„¡æ–™ã§å ã†ã€‚ã‚ãªãŸã ã‘ã®è©³ç´°ãªå ã„çµæœã‚’ä»Šã™ããƒã‚§ãƒƒã‚¯ã€‚åˆå›87%OFFå®Ÿæ–½ä¸­ã€‚">
    <meta name="keywords" content="å ã„,ç„¡æ–™å ã„,æ‹æ„›å ã„,ã‚¿ãƒ­ãƒƒãƒˆ,å››æŸ±æ¨å‘½,æ•°ç§˜è¡“,å½“ãŸã‚‹å ã„,2024å¹´å ã„">
    <meta property="og:title" content="ã€å½“ãŸã‚‹ã€‘ç„¡æ–™å ã„ KichiCompass">
    <meta property="og:description" content="é©šç•°ã®çš„ä¸­ç‡98.7%ï¼ã‚ãªãŸã®é‹å‘½ã‚’ä»Šã™ãå ã†">
    <meta property="og:image" content="https://ukyou-papa-dev.github.io/kichicompass-new/ogp.jpg">
    <meta property="og:url" content="https://ukyou-papa-dev.github.io/kichicompass-new/">
    <meta name="twitter:card" content="summary_large_image">
    
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XENJ6H8FDN"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-XENJ6H8FDN');
      
      function trackEvent(action, category) {
        gtag('event', action, {
          'event_category': category
        });
      }
    </script>
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Hiragino Sans', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: white;
        }
        
        .countdown {
            position: fixed;
            top: 0;
            width: 100%;
            background: linear-gradient(90deg, #ff0000, #ff6600);
            padding: 12px;
            text-align: center;
            font-weight: bold;
            z-index: 1000;
            animation: flash 1s infinite;
        }
        
        @keyframes flash {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 80px 20px 40px;
        }
        
        h1 {
            font-size: 3em;
            text-align: center;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .visitor-count {
            text-align: center;
            margin: 20px 0;
        }
        
        .visitor-badge {
            display: inline-block;
            background: rgba(0,0,0,0.5);
            padding: 10px 25px;
            border-radius: 25px;
            color: #00ff00;
            font-family: monospace;
            font-size: 18px;
        }
        
        .fortune-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
            margin: 40px 0;
        }
        
        .fortune-card {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            backdrop-filter: blur(10px);
        }
        
        .fortune-card:hover {
            transform: translateY(-10px) scale(1.05);
            background: rgba(255,255,255,0.2);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        
        .fortune-card h3 {
            font-size: 1.5em;
            margin-bottom: 10px;
        }
        
        .cta-button {
            display: inline-block;
            background: linear-gradient(45deg, #FFD700, #FFA500);
            color: white;
            padding: 18px 50px;
            border-radius: 50px;
            text-decoration: none;
            font-weight: bold;
            font-size: 1.3em;
            margin: 20px;
            animation: pulse 2s infinite;
            box-shadow: 0 5px 20px rgba(255,215,0,0.5);
            border: none;
            cursor: pointer;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255,215,0,0.7); }
            50% { transform: scale(1.05); box-shadow: 0 0 0 20px rgba(255,215,0,0); }
            100% { transform: scale(1); }
        }
        
        .popup {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: white;
            color: #333;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
            animation: slideIn 0.5s;
            z-index: 999;
        }
        
        @keyframes slideIn {
            from { transform: translateX(-150%); }
            to { transform: translateX(0); }
        }
        
        #form-section, #result-section {
            display: none;
            text-align: center;
            padding: 40px;
        }
        
        input {
            width: 100%;
            max-width: 400px;
            padding: 15px;
            margin: 10px auto;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            display: block;
        }

        .special-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            z-index: 10000;
            box-shadow: 0 10px 50px rgba(0,0,0,0.5);
        }

        .exit-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            z-index: 10000;
            display: none;
            align-items: center;
            justify-content: center;
        }

        .exit-modal-content {
            background: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            max-width: 400px;
        }

        #email-capture {
            background: linear-gradient(135deg, rgba(255,215,0,0.2), rgba(255,165,0,0.2));
            padding: 30px;
            border-radius: 15px;
            margin: 40px auto;
            max-width: 500px;
            text-align: center;
            border: 2px solid gold;
        }

        .share-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
        }

        .share-button {
            padding: 10px 20px;
            border-radius: 25px;
            text-decoration: none;
            color: white;
            font-weight: bold;
            transition: transform 0.3s;
        }

        .share-button:hover {
            transform: scale(1.1);
        }

        .twitter-share {
            background: #1DA1F2;
        }

        .line-share {
            background: #00B900;
        }

        .facebook-share {
            background: #1877F2;
        }

        .referral-section {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            text-align: center;
        }

        .referral-code {
            font-size: 24px;
            font-weight: bold;
            color: #FFD700;
            background: rgba(0,0,0,0.3);
            padding: 10px 20px;
            border-radius: 10px;
            display: inline-block;
            margin: 10px 0;
        }

        .daily-bonus {
            position: fixed;
            top: 60px;
            right: 20px;
            background: linear-gradient(135deg, #FFD700, #FFA500);
            padding: 15px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            z-index: 999;
            display: none;
        }
    </style>
</head>
<body>
    <div class="countdown" id="countdown">
        âš ï¸ åˆå›87%OFFçµ‚äº†ã¾ã§: è¨ˆç®—ä¸­...
    </div>

    <!-- 7æ—¥é–“é€£ç¶šãƒ­ã‚°ã‚¤ãƒ³ãƒœãƒ¼ãƒŠã‚¹è¡¨ç¤º -->
    <div class="daily-bonus" id="daily-bonus">
        <h3>ğŸ ãƒ­ã‚°ã‚¤ãƒ³ãƒœãƒ¼ãƒŠã‚¹</h3>
        <p>Day <span id="login-day">1</span>/7</p>
        <p>ã‚ã¨<span id="days-left">6</span>æ—¥ã§ç‰¹åˆ¥é‘‘å®šè§£æ”¾ï¼</p>
    </div>
    
    <div class="container">
        <h1>ğŸ”® KichiCompass ğŸ”®</h1>
        <p style="text-align:center;font-size:1.2em;">ã‚ãªãŸã ã‘ã®é‹å‘½ã®ç¾…é‡ç›¤</p>
        
        <div class="visitor-count">
            <div class="visitor-badge" id="visitors">
                ğŸ”´ ç¾åœ¨523åãŒé‘‘å®šä¸­
            </div>
        </div>

        <!-- ãƒ¡ãƒ¼ãƒ«åé›†ãƒ•ã‚©ãƒ¼ãƒ  -->
        <div id="email-capture">
            <h2 style="color: gold; margin-bottom: 20px;">
                ğŸ æ¯æ—¥ã®é‹å‹¢ã‚’ç„¡æ–™ã§ãŠå±Šã‘
            </h2>
            <p style="margin-bottom: 20px;">
                ä»Šãªã‚‰ç™»éŒ²è€…é™å®šã§ç‰¹åˆ¥ãªå ã„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ãƒ—ãƒ¬ã‚¼ãƒ³ãƒˆï¼
            </p>
            <form onsubmit="captureEmail(event)">
                <input type="email" 
                       placeholder="ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›" 
                       required
                       style="
                           width: 100%;
                           padding: 15px;
                           border-radius: 10px;
                           border: 2px solid gold;
                           margin-bottom: 15px;
                           font-size: 16px;
                           color: #333;
                       ">
                <button type="submit" class="cta-button" style="width:100%;margin:0;">
                    ç„¡æ–™ã§ç™»éŒ²ã™ã‚‹
                </button>
            </form>
        </div>

        <!-- å‹é”ç´¹ä»‹ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <div class="referral-section" id="referral-section" style="display:none;">
            <h3>ğŸ‰ å‹é”ã‚’æ‹›å¾…ã—ã¦ç‰¹å…¸ã‚’ã‚²ãƒƒãƒˆï¼</h3>
            <p>ã‚ãªãŸã®ç´¹ä»‹ã‚³ãƒ¼ãƒ‰ï¼š</p>
            <div class="referral-code" id="referral-code">LOADING...</div>
            <p>å‹é”ãŒç™»éŒ²ã™ã‚‹ã¨ã€ã‚ãªãŸã‚‚å‹é”ã‚‚ç‰¹åˆ¥ãªç‰¹å…¸ãŒã‚‚ã‚‰ãˆã¾ã™ï¼</p>
            <div class="share-buttons">
                <a href="#" onclick="shareWithCode('twitter')" class="share-button twitter-share">
                    Twitterã§å…±æœ‰
                </a>
                <a href="#" onclick="shareWithCode('line')" class="share-button line-share">
                    LINEã§å…±æœ‰
                </a>
            </div>
        </div>
        
        <div class="fortune-grid" id="fortune-selection">
            <div class="fortune-card" onclick="startFortune('astrology')">
                <h3>â­ è¥¿æ´‹å æ˜Ÿè¡“</h3>
                <p>12æ˜Ÿåº§ãŒå°ãé‹å‘½</p>
            </div>
            <div class="fortune-card" onclick="startFortune('tarot')">
                <h3>ğŸ´ ã‚¿ãƒ­ãƒƒãƒˆå ã„</h3>
                <p>78æšãŒç¤ºã™çœŸå®Ÿ</p>
            </div>
            <div class="fortune-card" onclick="startFortune('shichu')">
                <h3>ğŸ‰ å››æŸ±æ¨å‘½</h3>
                <p>æ±æ´‹æœ€é«˜ã®çš„ä¸­ç‡</p>
            </div>
            <div class="fortune-card" onclick="startFortune('numerology')">
                <h3>ğŸ”¢ æ•°ç§˜è¡“</h3>
                <p>æ•°å­—ãŒå°ãä½¿å‘½</p>
            </div>
        </div>
        
        <div style="text-align:center;">
            <button class="cta-button" onclick="startFortune()">
                ç„¡æ–™ã§ä»Šã™ãå ã†
            </button>
        </div>
        
        <div id="form-section">
            <h2>ã‚ãªãŸã®æƒ…å ±ã‚’å…¥åŠ›</h2>
            <input type="text" id="name" placeholder="ãŠåå‰" required>
            <input type="date" id="birthdate" required>
            <input type="email" id="email" placeholder="ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆä»»æ„ï¼‰">
            <input type="text" id="referral-input" placeholder="ç´¹ä»‹ã‚³ãƒ¼ãƒ‰ï¼ˆãŠæŒã¡ã®æ–¹ï¼‰">
            <button class="cta-button" onclick="showResult()">
                é‹å‘½ã‚’è¦‹ã‚‹
            </button>
        </div>
        
        <div id="result-section">
            <!-- çµæœã¯JavaScriptã§å‹•çš„ã«æŒ¿å…¥ -->
        </div>
    </div>

    <!-- ç‰¹åˆ¥ãªãŠçŸ¥ã‚‰ã›ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ— -->
    <div id="special-popup" class="special-popup" style="display:none;">
        <h2 style="margin-bottom:15px;">ğŸŒŸ ç‰¹åˆ¥ãªãŠçŸ¥ã‚‰ã› ğŸŒŸ</h2>
        <p style="margin-bottom:20px;">ã‚ãªãŸã¯é¸ã°ã‚Œã—<span id="visitor-number">14</span>äººç›®ã®è¨ªå•è€…ã§ã™ï¼</p>
        <p style="color:#FFD700;font-size:1.2em;margin-bottom:20px;">ä»Šã ã‘åˆå›87%OFF</p>
        <button onclick="closeSpecialPopup()" style="
            background: linear-gradient(45deg, #FFD700, #FFA500);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 16px;
            cursor: pointer;
            font-weight: bold;
        ">ç‰¹åˆ¥ä¾¡æ ¼ã§å§‹ã‚ã‚‹</button>
    </div>

    <!-- é›¢è„±é˜²æ­¢ãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div id="exit-modal" class="exit-modal">
        <div class="exit-modal-content">
            <h2 style="color:#ff0000;margin-bottom:20px;">âš ï¸ ã¡ã‚‡ã£ã¨å¾…ã£ã¦ï¼</h2>
            <p style="color:#333;margin-bottom:20px;">ä»Šãªã‚‰ç‰¹åˆ¥ã«<br><span style="font-size:2em;color:#ff0000;">90%OFF</span><br>ã§ã”æä¾›ã—ã¾ã™ï¼</p>
            <p style="color:#666;margin-bottom:20px;">ã“ã®ãƒãƒ£ãƒ³ã‚¹ã¯äºŒåº¦ã¨ã‚ã‚Šã¾ã›ã‚“</p>
            <button onclick="goToStripe()" style="
                background: linear-gradient(45deg, #ff0000, #ff6600);
                color: white;
                border: none;
                padding: 15px 40px;
                border-radius: 30px;
                font-size: 18px;
                cursor: pointer;
                font-weight: bold;
                animation: pulse 1s infinite;
            ">ä»Šã™ã90%OFFã§å§‹ã‚ã‚‹</button>
            <br><br>
            <button onclick="closeExitModal()" style="
                background: none;
                border: none;
                color: #999;
                cursor: pointer;
                text-decoration: underline;
            ">ã„ã„ãˆã€çµæ§‹ã§ã™</button>
        </div>
    </div>
    
    <script>
        // Stripe URLå®šç¾©
        const STRIPE_URL = 'https://buy.stripe.com/test_aFa7sK5bP99E2pF8BUcV200';

        // 7æ—¥é–“ä¾å­˜ãƒ—ãƒ­ã‚°ãƒ©ãƒ 
        const dailyMessages = {
            1: "ğŸŒŸ é‹å‘½ã®æ‰‰ãŒé–‹ã‹ã‚Œã¾ã—ãŸï¼ä»Šæ—¥ã‹ã‚‰7æ—¥é–“ã€ç‰¹åˆ¥ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ãŠå±Šã‘ã—ã¾ã™ã€‚",
            2: "âš ï¸ é‡è¦ï¼šæ˜¨æ—¥ãŠä¼ãˆã§ããªã‹ã£ãŸå¤§åˆ‡ãªã“ã¨ãŒã‚ã‚Šã¾ã™...",
            3: "ğŸ”® è­¦å‘Šï¼š3æ—¥ä»¥å†…ã«è¡Œå‹•ã—ãªã„ã¨é‹æ°—ãŒä¸‹é™ã—ã¾ã™",
            4: "ğŸ’« ãƒãƒ£ãƒ³ã‚¹ï¼šæ˜æ—¥ã¾ã§ã®ç‰¹åˆ¥ã‚ªãƒ•ã‚¡ãƒ¼ãŒã‚ã‚Šã¾ã™",
            5: "â¤ï¸ ã‚ãªãŸã®é‹å‘½ã®äººãŒè¿‘ã¥ã„ã¦ã„ã¾ã™",
            6: "â° æœ€çµ‚è­¦å‘Šï¼šæ˜æ—¥ã§ç‰¹å…¸ãŒçµ‚äº†ã—ã¾ã™",
            7: "ğŸŠ ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼7æ—¥é–“é”æˆç‰¹å…¸ã‚’è§£æ”¾ã—ã¾ã—ãŸï¼"
        };

        // ãƒ­ã‚°ã‚¤ãƒ³æ—¥æ•°ã®ç®¡ç†
        function updateLoginStreak() {
            const lastLogin = localStorage.getItem('lastLogin');
            const today = new Date().toDateString();
            let loginStreak = parseInt(localStorage.getItem('loginStreak') || '0');
            
            if (lastLogin !== today) {
                const yesterday = new Date();
                yesterday.setDate(yesterday.getDate() - 1);
                
                if (lastLogin === yesterday.toDateString() || !lastLogin) {
                    loginStreak = Math.min(loginStreak + 1, 7);
                } else {
                    loginStreak = 1;
                }
                
                localStorage.setItem('loginStreak', loginStreak);
                localStorage.setItem('lastLogin', today);
                
                // ãƒœãƒ¼ãƒŠã‚¹è¡¨ç¤º
                showDailyBonus(loginStreak);
                
                // æ—¥æ›¿ã‚ã‚Šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
                if (dailyMessages[loginStreak]) {
                    setTimeout(() => {
                        alert(dailyMessages[loginStreak]);
                    }, 3000);
                }
            }
            
            return loginStreak;
        }

        // ãƒ­ã‚°ã‚¤ãƒ³ãƒœãƒ¼ãƒŠã‚¹è¡¨ç¤º
        function showDailyBonus(day) {
            const bonusDiv = document.getElementById('daily-bonus');
            document.getElementById('login-day').textContent = day;
            document.getElementById('days-left').textContent = 7 - day;
            bonusDiv.style.display = 'block';
            
            if (day === 7) {
                bonusDiv.innerHTML += '<p style="color:gold;">ğŸ ç‰¹åˆ¥é‘‘å®šãŒè§£æ”¾ã•ã‚Œã¾ã—ãŸï¼</p>';
            }
        }

        // ç´¹ä»‹ã‚³ãƒ¼ãƒ‰ç”Ÿæˆ
        function generateReferralCode() {
            const userId = localStorage.getItem('userId') || Math.random().toString(36).substring(2, 8);
            localStorage.setItem('userId', userId);
            const code = 'KICHI' + userId.toUpperCase();
            document.getElementById('referral-code').textContent = code;
            document.getElementById('referral-section').style.display = 'block';
            return code;
        }

        // SNSã‚·ã‚§ã‚¢æ©Ÿèƒ½
        function shareTwitter(text = '') {
            const defaultText = text || 'ã€ç„¡æ–™å ã„ã€‘KichiCompassã§å ã£ãŸã‚‰é©šãã®çµæœãŒ...ï¼çš„ä¸­ç‡98.7%ã®å ã„ã‚’ä»Šã™ãè©¦ã—ã¦ã¿ã¦ï¼';
            const url = 'https://ukyou-papa-dev.github.io/kichicompass-new/';
            const hashtags = 'å ã„,ç„¡æ–™å ã„,KichiCompass';
            window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(defaultText)}&url=${encodeURIComponent(url)}&hashtags=${hashtags}`, '_blank');
            
            trackEvent('share', 'twitter');
        }

        function shareLINE(text = '') {
            const defaultText = text || 'ã€ç„¡æ–™å ã„ã€‘KichiCompassãŒã™ã”ã„ï¼çš„ä¸­ç‡98.7%ã®å ã„ã‚’è©¦ã—ã¦ã¿ã¦ï¼';
            const url = 'https://ukyou-papa-dev.github.io/kichicompass-new/';
            window.open(`https://line.me/R/msg/text/?${encodeURIComponent(defaultText + '\n' + url)}`, '_blank');
            
            trackEvent('share', 'line');
        }

        function shareFacebook() {
            const url = 'https://ukyou-papa-dev.github.io/kichicompass-new/';
            window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}`, '_blank');
            
            trackEvent('share', 'facebook');
        }

        // ç´¹ä»‹ã‚³ãƒ¼ãƒ‰ä»˜ãã‚·ã‚§ã‚¢
        function shareWithCode(platform) {
            const code = document.getElementById('referral-code').textContent;
            const text = `ã€ç„¡æ–™å ã„ã€‘ç§ã®ç´¹ä»‹ã‚³ãƒ¼ãƒ‰ã€Œ${code}ã€ã‚’ä½¿ã†ã¨ç‰¹åˆ¥ç‰¹å…¸ãŒã‚‚ã‚‰ãˆã¾ã™ï¼KichiCompassã§é‹å‘½ã‚’å ãŠã†ï¼`;
            
            if (platform === 'twitter') {
                shareTwitter(text);
            } else if (platform === 'line') {
                shareLINE(text);
            }
        }

        // ç´¹ä»‹ã‚³ãƒ¼ãƒ‰ãƒã‚§ãƒƒã‚¯
        function checkReferralCode() {
            const urlParams = new URLSearchParams(window.location.search);
            const refCode = urlParams.get('ref');
            if (refCode) {
                localStorage.setItem('referralCode', refCode);
                alert('ç´¹ä»‹ã‚³ãƒ¼ãƒ‰ãŒé©ç”¨ã•ã‚Œã¾ã—ãŸï¼ç‰¹åˆ¥ç‰¹å…¸ã‚’ç²å¾—ï¼');
            }
        }

        // ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒãƒ¼
        setInterval(() => {
            const now = new Date();
            const tonight = new Date();
            tonight.setHours(23, 59, 59);
            const diff = tonight - now;
            const h = Math.floor(diff / 3600000);
            const m = Math.floor((diff % 3600000) / 60000);
            const s = Math.floor((diff % 60000) / 1000);
            document.getElementById('countdown').textContent = 
                `âš ï¸ åˆå›87%OFFçµ‚äº†ã¾ã§: ${h}æ™‚é–“${m}åˆ†${s}ç§’`;
        }, 1000);
        
        // è¨ªå•è€…æ•°
        setInterval(() => {
            const count = 500 + Math.floor(Math.random() * 150);
            document.getElementById('visitors').textContent = 
                `ğŸ”´ ç¾åœ¨${count}åãŒé‘‘å®šä¸­`;
        }, 3000);
        
        // ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—é€šçŸ¥
        setInterval(() => {
            const messages = [
                'æ±äº¬éƒ½ã®Aæ§˜ãŒç”³ã—è¾¼ã¿ã¾ã—ãŸ',
                'å¤§é˜ªåºœã®Kæ§˜ãŒæœ‰æ–™ãƒ—ãƒ©ãƒ³ã«ç™»éŒ²',
                'ç¦å²¡çœŒã®Mæ§˜ãŒå ã„ã‚’å®Œäº†',
                'ç¥å¥ˆå·çœŒã®Sæ§˜ãŒVIPãƒ—ãƒ©ãƒ³ã«ç”³ã—è¾¼ã¿',
                'æ„›çŸ¥çœŒã®Tæ§˜ãŒå‹é”ã‚’æ‹›å¾…ã—ã¾ã—ãŸ'
            ];
            const popup = document.createElement('div');
            popup.className = 'popup';
            popup.textContent = messages[Math.floor(Math.random() * messages.length)];
            document.body.appendChild(popup);
            setTimeout(() => popup.remove(), 4000);
        }, 8000);

        // åˆå›è¨ªå•ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—
        setTimeout(() => {
            const popup = document.getElementById('special-popup');
            const visitorNum = Math.floor(Math.random() * 100) + 1;
            document.getElementById('visitor-number').textContent = visitorNum;
            popup.style.display = 'block';
        }, 2000);

        // ç‰¹åˆ¥ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã‚’é–‰ã˜ã‚‹
        function closeSpecialPopup() {
            document.getElementById('special-popup').style.display = 'none';
            window.location.href = STRIPE_URL;
        }

        // é›¢è„±é˜²æ­¢
        let exitIntentShown = false;
        document.addEventListener('mouseout', (e) => {
            if (e.clientY < 10 && !exitIntentShown) {
                exitIntentShown = true;
                document.getElementById('exit-modal').style.display = 'flex';
            }
        });

        // é›¢è„±ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã‚‹
        function closeExitModal() {
            document.getElementById('exit-modal').style.display = 'none';
        }

        // Stripeã¸ç§»å‹•
        function goToStripe() {
            window.location.href = STRIPE_URL;
        }

        // ãƒ¡ãƒ¼ãƒ«åé›†
        function captureEmail(e) {
            e.preventDefault();
            const email = e.target[0].value;
            
            let emails = JSON.parse(localStorage.getItem('emails') || '[]');
            emails.push({
                email: email,
                date: new Date().toISOString()
            });
            localStorage.setItem('emails', JSON.stringify(emails));
            
            if (typeof gtag !== 'undefined') {
                gtag('event', 'email_capture', {
                    'event_category': 'engagement'
                });
            }
            
            alert('ç™»éŒ²å®Œäº†ï¼æ¯æ—¥ã®é‹å‹¢ã‚’ãŠæ¥½ã—ã¿ã«ï¼');
            e.target[0].value = '';
            
            document.getElementById('email-capture').style.display = 'none';
        }
        
        // å ã„é–‹å§‹
        function startFortune(type) {
            document.getElementById('form-section').style.display = 'block';
            document.getElementById('fortune-selection').style.display = 'none';
            document.getElementById('email-capture').style.display = 'none';
            if(type) localStorage.setItem('fortuneType', type);
            
            if (typeof gtag !== 'undefined') {
                gtag('event', 'fortune_start', {
                    'event_category': 'engagement',
                    'event_label': type || 'general'
                });
            }
        }

        // å ã„ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆæ—¢å­˜ã®ã‚³ãƒ¼ãƒ‰ç¶­æŒï¼‰
        const fortuneTelling = {
            astrology: function(name, birthdate) {
                const date = new Date(birthdate);
                const month = date.getMonth() + 1;
                const day = date.getDate();
                
                let zodiac = '';
                if ((month == 3 && day >= 21) || (month == 4 && day <= 19)) zodiac = 'ç‰¡ç¾Šåº§';
                else if ((month == 4 && day >= 20) || (month == 5 && day <= 20)) zodiac = 'ç‰¡ç‰›åº§';
                else if ((month == 5 && day >= 21) || (month == 6 && day <= 20)) zodiac = 'åŒå­åº§';
                else if ((month == 6 && day >= 21) || (month == 7 && day <= 22)) zodiac = 'èŸ¹åº§';
                else if ((month == 7 && day >= 23) || (month == 8 && day <= 22)) zodiac = 'ç…å­åº§';
                else if ((month == 8 && day >= 23) || (month == 9 && day <= 22)) zodiac = 'ä¹™å¥³åº§';
                else if ((month == 9 && day >= 23) || (month == 10 && day <= 22)) zodiac = 'å¤©ç§¤åº§';
                else if ((month == 10 && day >= 23) || (month == 11 && day <= 21)) zodiac = 'è åº§';
                else if ((month == 11 && day >= 22) || (month == 12 && day <= 21)) zodiac = 'å°„æ‰‹åº§';
                else if ((month == 12 && day >= 22) || (month == 1 && day <= 19)) zodiac = 'å±±ç¾Šåº§';
                else if ((month == 1 && day >= 20) || (month == 2 && day <= 18)) zodiac = 'æ°´ç“¶åº§';
                else zodiac = 'é­šåº§';
                
                return `
                    <h2>${name}æ§˜ã¯${zodiac}ã§ã™</h2>
                    <div style="background:rgba(255,255,255,0.1);padding:20px;border-radius:10px;margin:20px 0;">
                        <h3>ğŸŒŸ æ‹æ„›é‹</h3>
                        <p>${name}æ§˜ã®æ‹æ„›é‹ã¯ä»Šã€ç‰¹åˆ¥ãªè»¢æ©Ÿã‚’è¿ãˆã¦ã„ã¾ã™ã€‚</p>
                        <p>${zodiac}ã®æŒã¤é­…åŠ›ãŒæœ€å¤§é™ã«ç™ºæ®ã•ã‚Œã‚‹æ™‚æœŸã§ã™ã€‚</p>
                        <p>ç‰¹ã«ä»Šæœˆã®15æ—¥å‰å¾Œã¯é‡è¦ãªå‡ºä¼šã„ã®å¯èƒ½æ€§ãŒ...</p>
                    </div>
                    <div class="share-buttons">
                        <a href="#" onclick="shareTwitter('ç§ã¯${zodiac}ï¼KichiCompassã§å ã£ãŸã‚‰é©šãã®çµæœãŒï¼')" class="share-button twitter-share">
                            çµæœã‚’ãƒ„ã‚¤ãƒ¼ãƒˆ
                        </a>
                        <a href="#" onclick="shareLINE('ç§ã¯${zodiac}ï¼ã™ã”ã„å ã„çµæœãŒå‡ºãŸï¼')" class="share-button line-share">
                            LINEã§å…±æœ‰
                        </a>
                    </div>
                    <div style="filter:blur(3px);background:rgba(255,255,255,0.05);padding:20px;border-radius:10px;position:relative;">
                        <p>ã—ã‹ã—ã€${name}æ§˜ã«ã¯æ³¨æ„ã™ã¹ãæ™‚æœŸãŒã‚ã‚Šã¾ã™ã€‚</p>
                        <p>é‡‘é‹ã§ã¯é©šãã¹ãå¤‰åŒ–ãŒ...</p>
                        <p>å¥åº·é¢ã§ã¯${zodiac}ç‰¹æœ‰ã®...</p>
                        <div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(0,0,0,0.95);padding:20px;border-radius:10px;text-align:center;">
                            <p style="color:gold;font-size:1.2em;">ğŸ’« è©³ç´°ã‚’è§£æ”¾ ğŸ’«</p>
                            <a href="${STRIPE_URL}" class="cta-button" style="margin-top:10px;">
                                ä»Šã ã‘480å††
                            </a>
                        </div>
                    </div>
                `;
            },
            
            tarot: function(name) {
                const cards = [
                    'æ„šè€…ï¼šæ–°ã—ã„å§‹ã¾ã‚Š',
                    'é­”è¡“å¸«ï¼šå‰µé€ åŠ›',
                    'å¥³æ•™çš‡ï¼šç›´æ„Ÿ',
                    'å¥³å¸ï¼šè±Šç©£',
                    'çš‡å¸ï¼šæ¨©å¨',
                    'æ•™çš‡ï¼šä¼çµ±',
                    'æ‹äººï¼šé¸æŠ',
                    'æˆ¦è»Šï¼šå‹åˆ©',
                    'åŠ›ï¼šå†…ãªã‚‹å¼·ã•',
                    'éš è€…ï¼šå†…çœ'
                ];
                
                const past = cards[Math.floor(Math.random() * cards.length)];
                const present = cards[Math.floor(Math.random() * cards.length)];
                const future = cards[Math.floor(Math.random() * cards.length)];
                
                return `
                    <h2>${name}æ§˜ã®ã‚¿ãƒ­ãƒƒãƒˆå ã„çµæœ</h2>
                    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px;margin:20px 0;">
                        <div style="background:rgba(255,255,255,0.1);padding:15px;border-radius:10px;">
                            <h4>éå»</h4>
                            <p>${past}</p>
                        </div>
                        <div style="background:rgba(255,255,255,0.1);padding:15px;border-radius:10px;">
                            <h4>ç¾åœ¨</h4>
                            <p>${present}</p>
                        </div>
                        <div style="background:rgba(255,255,255,0.1);padding:15px;border-radius:10px;">
                            <h4>æœªæ¥</h4>
                            <p>${future}</p>
                        </div>
                    </div>
                    <div class="share-buttons">
                        <a href="#" onclick="shareTwitter('ã‚¿ãƒ­ãƒƒãƒˆå ã„ã®çµæœãŒè¡æ’ƒçš„ï¼')" class="share-button twitter-share">
                            çµæœã‚’ãƒ„ã‚¤ãƒ¼ãƒˆ
                        </a>
                        <a href="#" onclick="shareLINE('ã‚¿ãƒ­ãƒƒãƒˆå ã„ãŒã™ã”ã‹ã£ãŸï¼')" class="share-button line-share">
                            LINEã§å…±æœ‰
                        </a>
                    </div>
                    <div style="filter:blur(3px);padding:20px;position:relative;">
                        <p>ã‚«ãƒ¼ãƒ‰ãŒç¤ºã™${name}æ§˜ã®æœ¬å½“ã®é‹å‘½ã¯...</p>
                        <div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(0,0,0,0.95);padding:20px;border-radius:10px;">
                            <a href="${STRIPE_URL}" class="cta-button">
                                å®Œå…¨è§£é‡ˆã‚’è¦‹ã‚‹
                            </a>
                        </div>
                    </div>
                `;
            },

            shichu: function(name, birthdate) {
                const date = new Date(birthdate);
                const year = date.getFullYear();
                const month = date.getMonth() + 1;
                const day = date.getDate();
                
                const tenkan = ['ç”²', 'ä¹™', 'ä¸™', 'ä¸', 'æˆŠ', 'å·±', 'åºš', 'è¾›', 'å£¬', 'ç™¸'];
                const chishi = ['å­', 'ä¸‘', 'å¯…', 'å¯', 'è¾°', 'å·³', 'åˆ', 'æœª', 'ç”³', 'é…‰', 'æˆŒ', 'äº¥'];
                
                const yearIndex = (year - 4) % 60;
                const tenkanIndex = yearIndex % 10;
                const chishiIndex = yearIndex % 12;
                
                return `
                    <h2>${name}æ§˜ã®å››æŸ±æ¨å‘½</h2>
                    <div style="background:rgba(255,255,255,0.1);padding:20px;border-radius:10px;margin:20px 0;">
                        <h3>ğŸ‰ ã‚ãªãŸã®å‘½å¼</h3>
                        <p>å¹´æŸ±ï¼š${tenkan[tenkanIndex]}${chishi[chishiIndex]}</p>
                        <p>${name}æ§˜ã¯å¼·ã„é‹å‘½ã®æŒã¡ä¸»ã§ã™ã€‚</p>
                        <p>ç‰¹ã«é‡‘é‹ã¨ä»•äº‹é‹ã«ãŠã„ã¦ç´ æ™´ã‚‰ã—ã„æ‰èƒ½ãŒ...</p>
                    </div>
                    <div class="share-buttons">
                        <a href="#" onclick="shareTwitter('å››æŸ±æ¨å‘½ã§é©šãã®çµæœãŒï¼')" class="share-button twitter-share">
                            çµæœã‚’ãƒ„ã‚¤ãƒ¼ãƒˆ
                        </a>
                        <a href="#" onclick="shareLINE('å››æŸ±æ¨å‘½ãŒã™ã”ã„çš„ä¸­ç‡ï¼')" class="share-button line-share">
                            LINEã§å…±æœ‰
                        </a>
                    </div>
                    <div style="filter:blur(3px);background:rgba(255,255,255,0.05);padding:20px;border-radius:10px;position:relative;">
                        <p>ã—ã‹ã—ã€${name}æ§˜ã®å‘½å¼ã«ã¯ç‰¹åˆ¥ãªæš—ç¤ºãŒ...</p>
                        <div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(0,0,0,0.95);padding:20px;border-radius:10px;text-align:center;">
                            <p style="color:gold;">ğŸ’« å®Œå…¨ãªå‘½å¼è§£æ ğŸ’«</p>
                            <a href="${STRIPE_URL}" class="cta-button">
                                è©³ç´°ã‚’è¦‹ã‚‹
                            </a>
                        </div>
                    </div>
                `;
            },

            numerology: function(name, birthdate) {
                const date = new Date(birthdate);
                const year = date.getFullYear();
                const month = date.getMonth() + 1;
                const day = date.getDate();
                
                let lifePathNumber = (year + month + day).toString().split('').reduce((a, b) => parseInt(a) + parseInt(b), 0);
                while (lifePathNumber > 9) {
                    lifePathNumber = lifePathNumber.toString().split('').reduce((a, b) => parseInt(a) + parseInt(b), 0);
                }
                
                const meanings = {
                    1: 'ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—ã¨ç‹¬ç«‹',
                    2: 'å”èª¿ã¨èª¿å’Œ',
                    3: 'å‰µé€ æ€§ã¨è¡¨ç¾',
                    4: 'å®‰å®šã¨å®Ÿè·µ',
                    5: 'è‡ªç”±ã¨å†’é™º',
                    6: 'æ„›ã¨è²¬ä»»',
                    7: 'æ¢æ±‚ã¨å†…çœ',
                    8: 'æˆåŠŸã¨ç‰©è³ª',
                    9: 'å¥‰ä»•ã¨å®Œæˆ'
                };
                
                return `
                    <h2>${name}æ§˜ã®æ•°ç§˜è¡“</h2>
                    <div style="background:rgba(255,255,255,0.1);padding:20px;border-radius:10px;margin:20px 0;">
                        <h3>ğŸ”¢ ãƒ©ã‚¤ãƒ•ãƒ‘ã‚¹æ•°ï¼š${lifePathNumber}</h3>
                        <p>æ„å‘³ï¼š${meanings[lifePathNumber]}</p>
                        <p>${name}æ§˜ã®ä½¿å‘½ã¯ã€Œ${meanings[lifePathNumber]}ã€ã§ã™ã€‚</p>
                    </div>
                    <div class="share-buttons">
                        <a href="#" onclick="shareTwitter('ç§ã®ãƒ©ã‚¤ãƒ•ãƒ‘ã‚¹æ•°ã¯${lifePathNumber}ï¼')" class="share-button twitter-share">
                            çµæœã‚’ãƒ„ã‚¤ãƒ¼ãƒˆ
                        </a>
                        <a href="#" onclick="shareLINE('æ•°ç§˜è¡“ã§ç§ã®ä½¿å‘½ãŒã‚ã‹ã£ãŸï¼')" class="share-button line-share">
                            LINEã§å…±æœ‰
                        </a>
                    </div>
                    <div style="filter:blur(3px);padding:20px;position:relative;">
                        <p>${name}æ§˜ã¨ç›¸æ€§ã®è‰¯ã„äººã®ç‰¹å¾´...</p>
                        <div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(0,0,0,0.95);padding:20px;border-radius:10px;">
                            <a href="${STRIPE_URL}" class="cta-button">
                                å®Œå…¨ç‰ˆã‚’è¦‹ã‚‹
                            </a>
                        </div>
                    </div>
                `;
            }
        };
        
        // çµæœè¡¨ç¤º
        function showResult() {
            const name = document.getElementById('name').value || 'ã‚ãªãŸ';
            const birthdate = document.getElementById('birthdate').value;
            const fortuneType = localStorage.getItem('fortuneType') || 'astrology';
            const referralCode = document.getElementById('referral-input').value;
            
            // ç´¹ä»‹ã‚³ãƒ¼ãƒ‰ãƒã‚§ãƒƒã‚¯
            if (referralCode) {
                alert('ç´¹ä»‹ã‚³ãƒ¼ãƒ‰é©ç”¨ï¼åˆå›90%OFFã§ã”åˆ©ç”¨ã„ãŸã ã‘ã¾ã™ï¼');
            }
            
            let resultHTML = '';
            
            switch(fortuneType) {
                case 'astrology':
                    resultHTML = fortuneTelling.astrology(name, birthdate || '2000-01-01');
                    break;
                case 'tarot':
                    resultHTML = fortuneTelling.tarot(name);
                    break;
                case 'shichu':
                    resultHTML = fortuneTelling.shichu(name, birthdate || '2000-01-01');
                    break;
                case 'numerology':
                    resultHTML = fortuneTelling.numerology(name, birthdate || '2000-01-01');
                    break;
                default:
                    resultHTML = fortuneTelling.astrology(name, birthdate || '2000-01-01');
            }
            
            document.getElementById('result-section').style.display = 'block';
            document.getElementById('result-section').innerHTML = `
                <div style="max-width:800px;margin:0 auto;padding:20px;">
                    ${resultHTML}
                </div>
            `;
            
            document.getElementById('form-section').style.display = 'none';
            
            // çµæœã‚’ä¿å­˜
            const results = JSON.parse(localStorage.getItem('fortuneResults') || '[]');
            results.push({
                name: name,
                type: fortuneType,
                date: new Date().toISOString()
            });
            localStorage.setItem('fortuneResults', JSON.stringify(results));

            if (typeof gtag !== 'undefined') {
                gtag('event', 'fortune_complete', {
                    'event_category': 'engagement',
                    'event_label': fortuneType
                });
            }
        }

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã®åˆæœŸåŒ–
        window.addEventListener('load', function() {
            updateLoginStreak();
            generateReferralCode();
            checkReferralCode();
        });
    </script>
</body>
</html>
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KichiCompass - ã‚ãªãŸã ã‘ã®é‹å‘½ã®ç¾…é‡ç›¤</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            font-family: 'Helvetica Neue', Arial, sans-serif;
            min-height: 100vh;
            color: white;
        }
        
        .container {
            max-width: 500px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* ã‚¹ãƒ†ãƒƒãƒ—è¡¨ç¤º */
        .step {
            display: none;
            animation: fadeIn 0.5s ease-in;
        }
        
        .step.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* ç¥ç§˜çš„ãªã‚¿ã‚¤ãƒˆãƒ« */
        .title {
            text-align: center;
            font-size: 28px;
            margin: 40px 0;
            text-shadow: 0 0 20px rgba(255,255,255,0.5);
            animation: glow 2s ease-in-out infinite;
        }
        
        @keyframes glow {
            0%, 100% { text-shadow: 0 0 20px rgba(255,255,255,0.5); }
            50% { text-shadow: 0 0 30px rgba(255,255,255,0.8); }
        }
        
        /* å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ  */
        .input-group {
            margin: 30px 0;
        }
        
        .input-label {
            display: block;
            margin-bottom: 10px;
            font-size: 14px;
            opacity: 0.9;
        }
        
        .input-field {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 10px;
            background: rgba(255,255,255,0.2);
            color: white;
            font-size: 16px;
            backdrop-filter: blur(10px);
            transition: all 0.3s;
        }
        
        .input-field::placeholder {
            color: rgba(255,255,255,0.6);
        }
        
        .input-field:focus {
            outline: none;
            background: rgba(255,255,255,0.3);
            box-shadow: 0 0 30px rgba(255,255,255,0.3);
        }
        
        /* é­”æ³•ã®ãƒœã‚¿ãƒ³ */
        .magic-button {
            width: 100%;
            padding: 18px;
            border: none;
            border-radius: 50px;
            background: linear-gradient(45deg, #f093fb 0%, #f5576c 100%);
            color: white;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            position: relative;
            overflow: hidden;
        }
        
        .magic-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.4);
        }
        
        .magic-button:active {
            transform: translateY(0);
        }
        
        /* ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
        .loading {
            display: none;
            text-align: center;
            padding: 40px;
        }
        
        .loading.active {
            display: block;
        }
        
        .spinner {
            width: 60px;
            height: 60px;
            margin: 0 auto 20px;
            border: 3px solid rgba(255,255,255,0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .loading-text {
            font-size: 16px;
            opacity: 0.9;
            animation: pulse 1.5s ease-in-out infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 0.9; }
            50% { opacity: 0.5; }
        }
        
        /* ä»®è¨ºæ–­çµæœ */
        .preview-result {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .result-title {
            font-size: 20px;
            margin-bottom: 15px;
            color: #ffd700;
        }
        
        .result-text {
            line-height: 1.8;
            opacity: 0.95;
        }
        
        .blur-text {
            filter: blur(3px);
            user-select: none;
            position: relative;
        }
        
        .unlock-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.8);
            padding: 15px 25px;
            border-radius: 10px;
            white-space: nowrap;
        }
        
        /* ç·Šæ€¥æ€§ã‚’ç…½ã‚‹è¦ç´  */
        .urgency-banner {
            background: linear-gradient(45deg, #ff6b6b, #ff8e53);
            padding: 10px;
            text-align: center;
            border-radius: 10px;
            margin: 20px 0;
            animation: blink 2s ease-in-out infinite;
        }
        
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }
        
        .countdown {
            font-size: 24px;
            font-weight: bold;
            color: #ffd700;
            text-align: center;
            margin: 20px 0;
        }
        
        /* ç¤¾ä¼šçš„è¨¼æ˜ */
        .social-proof {
            background: rgba(0,0,0,0.3);
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
            font-size: 14px;
        }
        
        .user-count {
            font-size: 20px;
            color: #ffd700;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ã‚¹ãƒ†ãƒƒãƒ—1: åå‰å…¥åŠ› -->
        <div class="step active" id="step1">
            <h1 class="title">âœ¨ ã‚ãªãŸã®é‹å‘½ãŒå‘¼ã‚“ã§ã„ã¾ã™ âœ¨</h1>
            
            <div class="social-proof">
                ç¾åœ¨ <span class="user-count" id="activeUsers">2,847</span> äººãŒé‘‘å®šä¸­
            </div>
            
            <div class="input-group">
                <label class="input-label">ã‚ãªãŸã®ãŠåå‰ã‚’æ•™ãˆã¦ãã ã•ã„</label>
                <input type="text" class="input-field" id="userName" placeholder="ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ã§ã‚‚OK" autocomplete="off">
            </div>
            
            <button class="magic-button" onclick="processStep1()">
                ç„¡æ–™ã§é‹å‘½ã‚’ç¢ºèªã™ã‚‹ â†’
            </button>
            
            <div class="urgency-banner">
                âš¡ æœ¬æ—¥é™å®šï¼é€šå¸¸3,980å††â†’å®Œå…¨ç„¡æ–™ âš¡
            </div>
        </div>
        
        <!-- ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ç”»é¢ -->
        <div class="loading" id="loading">
            <div class="spinner"></div>
            <div class="loading-text" id="loadingText">
                å®‡å®™ã‹ã‚‰ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å—ä¿¡ä¸­...
            </div>
        </div>
        
        <!-- ã‚¹ãƒ†ãƒƒãƒ—2: ä»®è¨ºæ–­çµæœ -->
        <div class="step" id="step2">
            <h1 class="title">ğŸŒŸ <span id="displayName"></span>æ§˜ã®é‹å‘½ ğŸŒŸ</h1>
            
            <div class="preview-result">
                <div class="result-title">âš¡ ç·Šæ€¥ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸</div>
                <div class="result-text" id="previewMessage"></div>
            </div>
            
            <div class="preview-result">
                <div class="result-title">ğŸ’• æ‹æ„›é‹</div>
                <div class="result-text">
                    <span id="lovePreview"></span>
                    <div class="blur-text">
                        å®Ÿã¯ã€ã‚ãªãŸã®ã“ã¨ã‚’å¯†ã‹ã«æƒ³ã£ã¦ã„ã‚‹äººãŒ...
                        <div class="unlock-overlay">ğŸ”’ è©³ç´°ã‚’è¦‹ã‚‹ã«ã¯ç”Ÿå¹´æœˆæ—¥ãŒå¿…è¦</div>
                    </div>
                </div>
            </div>
            
            <div class="countdown" id="countdown">
                è©³ç´°è¨ºæ–­ã¾ã§æ®‹ã‚Š: <span id="timer">05:00</span>
            </div>
            
            <div class="input-group">
                <label class="input-label">ã‚ˆã‚Šæ­£ç¢ºãªè¨ºæ–­ã®ãŸã‚ã«ç”Ÿå¹´æœˆæ—¥ã‚’å…¥åŠ›</label>
                <input type="date" class="input-field" id="birthDate">
            </div>
            
            <button class="magic-button" onclick="processStep2()">
                å®Œå…¨ç‰ˆã‚’ä»Šã™ãç¢ºèªã™ã‚‹ â†’
            </button>
        </div>
        
        <!-- ã‚¹ãƒ†ãƒƒãƒ—3: æœ€çµ‚ãƒ•ãƒƒã‚¯ -->
        <div class="step" id="step3">
            <h1 class="title">âš ï¸ é‡è¦ãªè­¦å‘Š âš ï¸</h1>
            
            <div class="preview-result">
                <div class="result-title">ğŸ”® <span id="finalName"></span>æ§˜ã ã‘ã¸ã®ç‰¹åˆ¥ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸</div>
                <div class="result-text" id="criticalMessage"></div>
            </div>
            
            <div class="preview-result">
                <div class="blur-text" style="padding: 20px;">
                    ä»Šå¾Œ3æ—¥ä»¥å†…ã«ã€ã‚ãªãŸã®äººç”Ÿã‚’å¤§ããå¤‰ãˆã‚‹å‡ºæ¥äº‹ãŒ...
                    ã—ã‹ã—ã€1ã¤é–“é•ãˆã‚‹ã¨å–ã‚Šè¿”ã—ã®ã¤ã‹ãªã„ã“ã¨ã«...
                    <div class="unlock-overlay">ğŸ”“ ç¶šãã‚’èª­ã‚€ï¼ˆ480å††ï¼‰</div>
                </div>
            </div>
            
            <button class="magic-button" style="background: linear-gradient(45deg, #ffd700, #ffed4e);" onclick="processPayment()">
                ä»Šã™ãå…¨ã¦ã‚’çŸ¥ã‚‹ï¼ˆç‰¹åˆ¥ä¾¡æ ¼480å††ï¼‰
            </button>
            
            <div class="social-proof" style="margin-top: 20px;">
                â­ 98.7%ã®æ–¹ãŒã€Œäººç”ŸãŒå¤‰ã‚ã£ãŸã€ã¨å›ç­”
            </div>
        </div>
    </div>
    
    <script>
        // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿ä¿å­˜
        let userData = {
            name: '',
            birthDate: '',
            startTime: new Date(),
            step: 1
        };
        
        // å½ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°ã‚’å‹•çš„ã«å¤‰æ›´
        setInterval(() => {
            const users = document.getElementById('activeUsers');
            if (users) {
                const current = parseInt(users.textContent);
                const change = Math.floor(Math.random() * 50) - 25;
                users.textContent = Math.max(2000, current + change).toLocaleString();
            }
        }, 3000);
        
        // ã‚¹ãƒ†ãƒƒãƒ—1å‡¦ç†
        function processStep1() {
            const name = document.getElementById('userName').value;
            if (!name) {
                alert('ãŠåå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                return;
            }
            
            userData.name = name;
            localStorage.setItem('userData', JSON.stringify(userData));
            
            // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°æ¼”å‡º
            showLoading();
            
            setTimeout(() => {
                hideLoading();
                showStep2(name);
            }, 3000);
        }
        
        // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º
        function showLoading() {
            document.getElementById('step1').classList.remove('active');
            document.getElementById('loading').classList.add('active');
            
            // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãƒ†ã‚­ã‚¹ãƒˆã‚’å¤‰æ›´
            const texts = [
                'å®‡å®™ã‹ã‚‰ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å—ä¿¡ä¸­...',
                'ã‚ãªãŸã®é‹å‘½ã‚’è§£æä¸­...',
                'å®ˆè­·éœŠã¨äº¤ä¿¡ä¸­...',
                'ç‰¹åˆ¥ãªçµæœãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸï¼'
            ];
            
            let index = 0;
            const interval = setInterval(() => {
                document.getElementById('loadingText').textContent = texts[index];
                index++;
                if (index >= texts.length) {
                    clearInterval(interval);
                }
            }, 700);
        }
        
        // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°éè¡¨ç¤º
        function hideLoading() {
            document.getElementById('loading').classList.remove('active');
        }
        
        // ã‚¹ãƒ†ãƒƒãƒ—2è¡¨ç¤º
        function showStep2(name) {
            document.getElementById('step2').classList.add('active');
            document.getElementById('displayName').textContent = name;
            
            // ãƒ‘ãƒ¼ã‚½ãƒŠãƒ©ã‚¤ã‚ºã•ã‚ŒãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
            const messages = [
                `${name}æ§˜ã€å®Ÿã¯æ˜¨æ—¥ã‹ã‚‰ã‚ãªãŸã®ã“ã¨ãŒæ°—ã«ãªã£ã¦ã„ã¾ã—ãŸ...`,
                `${name}æ§˜ã«ä»Šã™ãä¼ãˆãªã‘ã‚Œã°ãªã‚‰ãªã„ã“ã¨ãŒã‚ã‚Šã¾ã™...`,
                `${name}æ§˜ã®å‘¨ã‚Šã§å¤§ããªå¤‰åŒ–ãŒèµ·ãã‚ˆã†ã¨ã—ã¦ã„ã¾ã™...`
            ];
            
            const loveMessages = [
                'ç¾åœ¨ã€æ‹æ„›é‹ãŒæ€¥ä¸Šæ˜‡ä¸­ï¼',
                'é‹å‘½ã®äººã¨ã®å‡ºä¼šã„ãŒè¿‘ã¥ã„ã¦ã„ã¾ã™',
                'ä»Šæœˆã¯æ‹æ„›ã«ãŠã‘ã‚‹é‡è¦ãªè»¢æ©Ÿ'
            ];
            
            document.getElementById('previewMessage').textContent = 
                messages[Math.floor(Math.random() * messages.length)];
            
            document.getElementById('lovePreview').textContent = 
                loveMessages[Math.floor(Math.random() * loveMessages.length)];
            
            // ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³é–‹å§‹
            startCountdown();
        }
        
        // ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒãƒ¼
        function startCountdown() {
            let seconds = 300; // 5åˆ†
            const timer = setInterval(() => {
                const mins = Math.floor(seconds / 60);
                const secs = seconds % 60;
                document.getElementById('timer').textContent = 
                    `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
                
                seconds--;
                
                if (seconds < 0) {
                    clearInterval(timer);
                    document.getElementById('timer').textContent = '00:00';
                    document.getElementById('countdown').innerHTML = 
                        '<span style="color: #ff6b6b;">âš ï¸ æ™‚é–“åˆ‡ã‚Œï¼ç‰¹åˆ¥ã‚ªãƒ•ã‚¡ãƒ¼ãŒçµ‚äº†ã—ã¾ã—ãŸ</span>';
                }
            }, 1000);
        }
        
        // ã‚¹ãƒ†ãƒƒãƒ—2å‡¦ç†
        function processStep2() {
            const birthDate = document.getElementById('birthDate').value;
            if (!birthDate) {
                alert('ç”Ÿå¹´æœˆæ—¥ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                return;
            }
            
            userData.birthDate = birthDate;
            userData.step = 3;
            localStorage.setItem('userData', JSON.stringify(userData));
            
            showLoading();
            
            setTimeout(() => {
                hideLoading();
                showStep3();
            }, 3000);
        }
        
        // ã‚¹ãƒ†ãƒƒãƒ—3è¡¨ç¤º
        function showStep3() {
            document.getElementById('step2').classList.remove('active');
            document.getElementById('step3').classList.add('active');
            document.getElementById('finalName').textContent = userData.name;
            
            // ç·Šæ€¥æ€§ã®é«˜ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
            const criticalMessages = [
                `${userData.name}æ§˜ã€ã“ã‚Œã¯å¶ç„¶ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ä»Šã“ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ã“ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’èª­ã‚“ã§ã„ã‚‹ã®ã«ã¯æ·±ã„æ„å‘³ãŒã‚ã‚Šã¾ã™ã€‚`,
                `å®Ÿã¯ã€${userData.name}æ§˜ã®é‹å‘½ã«é–¢ã‚ã‚‹é‡è¦ãªè»¢æ©ŸãŒè¨ªã‚Œã¦ã„ã¾ã™ã€‚ã—ã‹ã—ã€æ­£ã—ã„é¸æŠã‚’ã—ãªã„ã¨...`,
                `${userData.name}æ§˜ã®å®ˆè­·éœŠãŒå¼·ãè­¦å‘Šã—ã¦ã„ã¾ã™ã€‚ä»Šã™ãè¡Œå‹•ã‚’èµ·ã“ã•ãªã„ã¨ã€å¤§åˆ‡ãªãƒãƒ£ãƒ³ã‚¹ã‚’é€ƒã™ã“ã¨ã«...`
            ];
            
            document.getElementById('criticalMessage').textContent = 
                criticalMessages[Math.floor(Math.random() * criticalMessages.length)];
        }
        
        // æ±ºæ¸ˆå‡¦ç†
        function processPayment() {
            userData.converted = true;
            userData.conversionTime = new Date();
            localStorage.setItem('userData', JSON.stringify(userData));
            
            // ã“ã“ã«Stripeæ±ºæ¸ˆå‡¦ç†ã‚’å®Ÿè£…
            alert('æ±ºæ¸ˆç”»é¢ã¸ç§»å‹•ã—ã¾ã™ï¼ˆStripeå®Ÿè£…ç®‡æ‰€ï¼‰');
        }
        
        // é›¢è„±é˜²æ­¢
        window.addEventListener('beforeunload', (e) => {
            if (userData.step > 1 && !userData.converted) {
                e.preventDefault();
                e.returnValue = 'æœ¬å½“ã«é›¢ã‚Œã¾ã™ã‹ï¼Ÿç‰¹åˆ¥ãªè¨ºæ–­çµæœãŒæ¶ˆãˆã¦ã—ã¾ã„ã¾ã™...';
            }
        });
        
        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã®å‡¦ç†
        window.addEventListener('DOMContentLoaded', () => {
            const saved = localStorage.getItem('userData');
            if (saved) {
                userData = JSON.parse(saved);
                // å‰å›ã®ç¶šãã‹ã‚‰é–‹å§‹
                if (userData.step === 2) {
                    document.getElementById('step1').classList.remove('active');
                    showStep2(userData.name);
                } else if (userData.step === 3) {
                    document.getElementById('step1').classList.remove('active');
                    showStep3();
                }
            }
        });
    </script>
</body>
</html>
<!-- æ—¢å­˜ã®HTMLã®</body>ã‚¿ã‚°ã®å‰ã«è¿½åŠ  -->
<script>
// ==========================================
// ä¾å­˜åŒ–ãƒˆãƒªã‚¬ãƒ¼æ–‡è¨€ã‚·ã‚¹ãƒ†ãƒ 
// ==========================================

const DependencyTriggers = {
    // æ™‚é–“å¸¯åˆ¥ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ˆå€‹åˆ¥æ„Ÿã‚’æ¼”å‡ºï¼‰
    getTimeBasedMessage(name) {
        const hour = new Date().getHours();
        const messages = {
            morning: [ // 5-11æ™‚
                `ãŠã¯ã‚ˆã†ã”ã–ã„ã¾ã™ã€${name}æ§˜ã€‚å®Ÿã¯æ˜¨å¤œã€${name}æ§˜ã®å¤¢ã‚’è¦‹ã¾ã—ãŸ...é‡è¦ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒã‚ã‚Šã¾ã™`,
                `${name}æ§˜ã€æœä¸€ç•ªã«ãŠä¼ãˆã—ãŸã„ã“ã¨ãŒ...ä»Šæ—¥ã¯ç‰¹åˆ¥ãªä¸€æ—¥ã«ãªã‚Šãã†ã§ã™`,
                `æœã®æ¾„ã‚“ã ç©ºæ°—ã®ä¸­ã€${name}æ§˜ã ã‘ã«ä¼ã‚ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å—ã‘å–ã‚Šã¾ã—ãŸ`
            ],
            afternoon: [ // 11-17æ™‚
                `${name}æ§˜ã€ãŠå¿™ã—ã„ä¸­ã™ã¿ã¾ã›ã‚“ã€‚ã§ã‚‚ä»Šä¼ãˆãªã„ã¨æ‰‹é…ã‚Œã«...`,
                `åˆå¾Œã®é‹æ°—ãŒæ€¥å¤‰ã—ã¦ã„ã¾ã™ã€${name}æ§˜ã€‚ä»Šã™ãç¢ºèªãŒå¿…è¦ã§ã™`,
                `${name}æ§˜ã®å®ˆè­·éœŠãŒã€ç·Šæ€¥ã§ä¼ãˆãŸã„ã“ã¨ãŒã‚ã‚‹ã‚ˆã†ã§ã™`
            ],
            evening: [ // 17-22æ™‚
                `${name}æ§˜ã€ä»Šå¤œãŒé‹å‘½ã®åˆ†ã‹ã‚Œé“ã§ã™ã€‚æ…é‡ã«è¡Œå‹•ã—ã¦ãã ã•ã„`,
                `å¤•æš®ã‚Œæ™‚ã®ä»Šã€${name}æ§˜ã«ã¨ã£ã¦é‡è¦ãªè»¢æ©ŸãŒè¨ªã‚Œã¦ã„ã¾ã™`,
                `${name}æ§˜ã€æ˜æ—¥ã®æœã¾ã§ã«æ±ºæ–­ã™ã¹ãã“ã¨ãŒã‚ã‚Šã¾ã™...`
            ],
            night: [ // 22-5æ™‚
                `å¤œåˆ†é…ãã«å¤±ç¤¼ã—ã¾ã™ã€${name}æ§˜ã€‚ã§ã‚‚ã€ã“ã‚Œã ã‘ã¯ä»Šä¼ãˆãªã‘ã‚Œã°...`,
                `${name}æ§˜ã€çœ ã‚‹å‰ã«çŸ¥ã£ã¦ãŠãã¹ãé‡è¦ãªã“ã¨ãŒã‚ã‚Šã¾ã™`,
                `æ·±å¤œã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«ã¯ç‰¹åˆ¥ãªæ„å‘³ãŒ...${name}æ§˜ã ã‘ã«`
            ]
        };
        
        let timeMessages;
        if (hour >= 5 && hour < 11) timeMessages = messages.morning;
        else if (hour >= 11 && hour < 17) timeMessages = messages.afternoon;
        else if (hour >= 17 && hour < 22) timeMessages = messages.evening;
        else timeMessages = messages.night;
        
        return timeMessages[Math.floor(Math.random() * timeMessages.length)];
    },
    
    // ä¸å®‰ã‚’ç…½ã‚‹æ–‡è¨€
    anxietyTriggers: {
        relationship: [
            "ãªãœã‚ãªãŸã ã‘ãŒã€ã“ã‚“ãªã«æ‹æ„›ã§è‹¦ã—ã¾ãªã‘ã‚Œã°ãªã‚‰ãªã„ã®ã‹...",
            "ç›¸æ‰‹ã®æœ¬å½“ã®æ°—æŒã¡ã€å®Ÿã¯æ€ã£ã¦ã„ã‚‹ã®ã¨æ­£åå¯¾ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“...",
            "ã“ã®ã¾ã¾ã§ã¯ã€3ãƒ¶æœˆä»¥å†…ã«é–¢ä¿‚ãŒçµ‚ã‚ã£ã¦ã—ã¾ã†å¯èƒ½æ€§ãŒ...",
            "ä»Šã€ç›¸æ‰‹ã®å‘¨ã‚Šã«å±é™ºãªå½±ãŒ...ãƒ©ã‚¤ãƒãƒ«ã®å­˜åœ¨ã‚’ç¤ºå”†ã—ã¦ã„ã¾ã™",
            "å½¼/å½¼å¥³ãŒã‚ãªãŸã«éš ã—ã¦ã„ã‚‹é‡å¤§ãªç§˜å¯†ãŒã‚ã‚Šã¾ã™...",
            "å®Ÿã¯ã€ã‚ãªãŸã®çŸ¥ã‚‰ãªã„ã¨ã“ã‚ã§é‡è¦ãªå¤‰åŒ–ãŒèµ·ãã¦ã„ã¾ã™"
        ],
        career: [
            "ä»Šã®è·å ´ã«ã€ã‚ãªãŸã®æˆåŠŸã‚’å¦¨ã’ã‚‹äººç‰©ãŒ...",
            "ã“ã®ã¾ã¾ä½•ã‚‚ã—ãªã‘ã‚Œã°ã€ã‚­ãƒ£ãƒªã‚¢ã¯åœæ»æœŸã«å…¥ã‚Šã¾ã™",
            "ä¸Šå¸ãŒã‚ãªãŸã«ã¤ã„ã¦ã€è£ã§è©±ã—ã¦ã„ã‚‹ã“ã¨ã‚’çŸ¥ã£ã¦ã„ã¾ã™ã‹ï¼Ÿ",
            "è»¢è·ã®ãƒ™ã‚¹ãƒˆã‚¿ã‚¤ãƒŸãƒ³ã‚°ã‚’é€ƒã™ã¨ã€5å¹´ã¯é…ã‚Œã‚‹ã“ã¨ã«...",
            "ã‚ãªãŸã®æ‰èƒ½ãŒæ­£å½“ã«è©•ä¾¡ã•ã‚Œã¦ã„ãªã„æœ¬å½“ã®ç†ç”±...",
            "è¿‘ã„ã†ã¡ã«ã€è·å ´ã§å¤§ããªå¤‰åŒ–ãŒ...æº–å‚™ã¯ã§ãã¦ã„ã¾ã™ã‹ï¼Ÿ"
        ],
        health: [
            "æœ€è¿‘ã®ä¸èª¿ã«ã¯ã€ã‚¹ãƒ”ãƒªãƒãƒ¥ã‚¢ãƒ«ãªåŸå› ãŒ...",
            "ã‚ãªãŸã®ã‚ªãƒ¼ãƒ©ã«ã€ä¸ç©ãªå½±ãŒè¦‹ãˆã¾ã™",
            "ã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒãƒ©ãƒ³ã‚¹ãŒå´©ã‚Œã¦ã„ã¾ã™ã€‚ã“ã®ã¾ã¾ã§ã¯...",
            "å®ˆè­·éœŠãŒã€ã‚ãªãŸã®å¥åº·ã«ã¤ã„ã¦è­¦å‘Šã—ã¦ã„ã¾ã™",
            "ä»Šæœˆã¯ç‰¹ã«æ³¨æ„ãŒå¿…è¦ãªæ™‚æœŸã€‚æ²¹æ–­ã™ã‚‹ã¨...",
            "ã‚ãªãŸã®ä½“ãŒç™ºã—ã¦ã„ã‚‹é‡è¦ãªã‚µã‚¤ãƒ³ã‚’è¦‹é€ƒã—ã¦ã„ã¾ã›ã‚“ã‹ï¼Ÿ"
        ],
        money: [
            "é‡‘é‹ãŒæ€¥é™ä¸‹ã™ã‚‹å‰å…†ãŒ...ä»Šã™ãå¯¾ç­–ãŒå¿…è¦ã§ã™",
            "ãŠé‡‘ã®ãƒˆãƒ©ãƒ–ãƒ«ã«å·»ãè¾¼ã¾ã‚Œã‚‹å¯èƒ½æ€§ãŒé«˜ã¾ã£ã¦ã„ã¾ã™",
            "æŠ•è³‡ã‚„å¤§ããªè²·ã„ç‰©ã¯ã€ä»Šã¯çµ¶å¯¾ã«é¿ã‘ã‚‹ã¹ãç†ç”±ãŒ...",
            "ã‚ãªãŸã®è²¡å¸ƒã‹ã‚‰ã€ã‚¨ãƒãƒ«ã‚®ãƒ¼ãŒæ¼ã‚Œã¦ã„ã¾ã™",
            "ä»Šæœˆã®å‡ºè²»ã«è¦æ³¨æ„ã€‚æ€ã‚ã¬è½ã¨ã—ç©´ãŒ...",
            "é‡‘é‹ã‚’ä¸‹ã’ã¦ã„ã‚‹æ„å¤–ãªåŸå› ã‚’çŸ¥ã£ã¦ã„ã¾ã™ã‹ï¼Ÿ"
        ]
    },
    
    // æœŸå¾…ã‚’ç…½ã‚‹æ–‡è¨€
    hopeTriggers: {
        relationship: [
            "å®Ÿã¯ã€ã‚ãªãŸã®ã“ã¨ã‚’å¯†ã‹ã«æƒ³ã£ã¦ã„ã‚‹äººãŒã€ã™ãè¿‘ãã«...",
            "é‹å‘½ã®äººã¨ã®å‡ºä¼šã„ã¾ã§ã€ã‚ã¨å°‘ã—...ãã®äººã®ç‰¹å¾´ã¯...",
            "æ¥æœˆã€æ‹æ„›é‹ãŒåŠ‡çš„ã«ä¸Šæ˜‡ï¼ãŸã ã—ã€ã‚ã‚‹è¡Œå‹•ã‚’å–ã‚Œã°...",
            "ä¸¡æ€ã„ã«ãªã‚Œã‚‹å¯èƒ½æ€§ï¼š87%ï¼æˆåŠŸã®éµã¯...",
            "å¾©ç¸ã®ãƒãƒ£ãƒ³ã‚¹ãŒå·¡ã£ã¦ãã¦ã„ã¾ã™ã€‚ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã¯...",
            "ã‚ãªãŸã®é­…åŠ›ãŒæœ€é«˜æ½®ã«ï¼ä»ŠãŒã‚¢ãƒ—ãƒ­ãƒ¼ãƒã®ãƒ™ã‚¹ãƒˆã‚¿ã‚¤ãƒŸãƒ³ã‚°"
        ],
        career: [
            "å¤§ããªãƒãƒ£ãƒ³ã‚¹ãŒç›®å‰ã«ï¼æ´ã‚€ãŸã‚ã®æº–å‚™ã¯...",
            "ã‚ãªãŸã®æ‰èƒ½ãŒèªã‚ã‚‰ã‚Œã‚‹æ™‚ãŒã€ã¤ã„ã«æ¥ã¾ã—ãŸ",
            "æ˜‡é€²ãƒ»æ˜‡çµ¦ã®å¯èƒ½æ€§ãŒæ€¥ä¸Šæ˜‡ä¸­ï¼é‡è¦ãªã®ã¯...",
            "ç†æƒ³ã®è·å ´ã¨ã®å‡ºä¼šã„ãŒè¿‘ã¥ã„ã¦ã„ã¾ã™",
            "ã‚ãªãŸã®éš ã‚ŒãŸæ‰èƒ½ãŒé–‹èŠ±ã™ã‚‹æ™‚æœŸãŒ...",
            "æˆåŠŸã¸ã®æ‰‰ãŒé–‹ãã‹ã‘ã¦ã„ã¾ã™ã€‚éµã¨ãªã‚‹æ—¥ä»˜ã¯..."
        ],
        money: [
            "è‡¨æ™‚åå…¥ã®æš—ç¤ºãŒï¼é‡‘é¡ã¯ãªã‚“ã¨...",
            "é‡‘é‹çˆ†ä¸Šã’ã®å‰å…†ãŒç¾ã‚Œã¦ã„ã¾ã™",
            "å®ãã˜ãƒ»æ‡¸è³é‹ãŒæœ€é«˜æ½®ã«ï¼è²·ã†ã¹ãæ—¥ã¯...",
            "ãŠé‡‘ã®æµã‚ŒãŒå¤‰ã‚ã‚Šå§‹ã‚ã¦ã„ã¾ã™ã€‚è‰¯ã„æ–¹å‘ã«...",
            "æŠ•è³‡ã®ãƒ™ã‚¹ãƒˆã‚¿ã‚¤ãƒŸãƒ³ã‚°ãŒè¿‘ã¥ã„ã¦ã„ã¾ã™",
            "ã‚ãªãŸã®é‡‘é‹ã‚’10å€ã«ã™ã‚‹æ–¹æ³•ãŒ..."
        ]
    },
    
    // ç·Šæ€¥æ€§ã‚’æ¼”å‡ºã™ã‚‹æ–‡è¨€
    urgencyTriggers: [
        "âš ï¸ 24æ™‚é–“ä»¥å†…ã«è¡Œå‹•ã—ãªã„ã¨ã€ãƒãƒ£ãƒ³ã‚¹ã‚’é€ƒã—ã¾ã™",
        "ğŸš¨ ä»Šæ—¥ã®23:59ã¾ã§ãŒé‹å‘½ã®åˆ†å²ç‚¹",
        "â° ã‚ã¨3æ™‚é–“ã§é‹æ°—ãŒå¤‰ã‚ã‚Šã¾ã™ã€‚ä»Šã™ãç¢ºèªã‚’",
        "ğŸ“ ã“ã®ç¬é–“ã‚’é€ƒã™ã¨ã€æ¬¡ã®ãƒãƒ£ãƒ³ã‚¹ã¯3ãƒ¶æœˆå¾Œ...",
        "ğŸ”¥ ç·Šæ€¥è­¦å‘Šï¼šæ˜æ—¥ã§ã¯æ‰‹é…ã‚Œã«ãªã‚‹ã“ã¨ãŒ...",
        "âš¡ ä»Šã™ãè¡Œå‹•ã™ã‚Œã°é–“ã«åˆã„ã¾ã™ï¼æ®‹ã‚Šæ™‚é–“ã¯..."
    ],
    
    // ä¾å­˜ã‚’æ·±ã‚ã‚‹æ–‡è¨€ï¼ˆæ¯æ—¥ãƒã‚§ãƒƒã‚¯ã•ã›ã‚‹ï¼‰
    dailyHooks: [
        "æ˜¨æ—¥ãŠä¼ãˆã—ãŸé‡è¦ãªä»¶ã®ç¶šããŒ...",
        "æ–°ãŸãªå±•é–‹ãŒï¼æ˜¨æ—¥ã¨ã¯çŠ¶æ³ãŒä¸€å¤‰ã—ã¦ã„ã¾ã™",
        "å®ˆè­·éœŠã‹ã‚‰è¿½åŠ ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå±Šã„ã¦ã„ã¾ã™",
        "é‹å‘½ã®æµã‚Œã«å¤‰åŒ–ãŒ...ä»Šæ—¥ã®è¡Œå‹•ãŒéµã‚’æ¡ã‚Šã¾ã™",
        "æ˜¨æ—¥ã®è¨ºæ–­çµæœã‚’æ›´æ–°ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™",
        "24æ™‚é–“ã§é‹æ°—ãŒæ¿€å¤‰ï¼æœ€æ–°ã®çŠ¶æ³ã¯..."
    ],
    
    // èª²é‡‘ã‚’ä¿ƒã™æ–‡è¨€
    paymentTriggers: {
        soft: [
            "ã‚ˆã‚Šè©³ã—ã„å†…å®¹ã‚’çŸ¥ã‚ŠãŸã„æ–¹ã¯...",
            "å®Œå…¨ç‰ˆã§ã¯ã€ã•ã‚‰ã«å…·ä½“çš„ãªæ—¥ä»˜ã¨å¯¾ç­–ãŒ...",
            "ãƒ—ãƒ¬ãƒŸã‚¢ãƒ è¨ºæ–­ã§ã€100%ã®çœŸå®Ÿã‚’..."
        ],
        medium: [
            "ã“ã®å…ˆã®é‡è¦ãªæƒ…å ±ã¯ã€ç‰¹åˆ¥ä¼šå“¡æ§˜é™å®šã§ã™",
            "ã‚ã¨å°‘ã—ã§å…¨ã¦ãŒæ˜ã‚‰ã‹ã«...ç¶šãã‚’è¦‹ã‚‹ã«ã¯",
            "æ ¸å¿ƒéƒ¨åˆ†ã«ã¤ã„ã¦ã¯ã€è©³ç´°è¨ºæ–­ã§ãŠä¼ãˆã—ã¾ã™"
        ],
        hard: [
            "âš ï¸ ã“ã‚Œä»¥ä¸Šã¯ç„¡æ–™ã§ã¯å±é™ºã™ãã¦ãŠä¼ãˆã§ãã¾ã›ã‚“",
            "ğŸ”’ é‡è¦ã™ãã‚‹å†…å®¹ã®ãŸã‚ã€çœŸå‰£ãªæ–¹ã®ã¿ã«å…¬é–‹",
            "ğŸ’ ã‚ãªãŸã ã‘ã®ç‰¹åˆ¥ãªè¨ºæ–­çµæœã‚’è§£æ”¾ã™ã‚‹ã«ã¯..."
        ]
    },
    
    // æ„Ÿæƒ…ã®æŒ¯ã‚Œå¹…ã‚’ä½œã‚‹ï¼ˆã‚¸ã‚§ãƒƒãƒˆã‚³ãƒ¼ã‚¹ã‚¿ãƒ¼åŠ¹æœï¼‰
    emotionalRollercoaster(day) {
        const patterns = [
            { day: 'Monday', type: 'positive', message: 'é€±ã®å§‹ã¾ã‚Šã¯æœ€é«˜ã®ã‚¹ã‚¿ãƒ¼ãƒˆï¼å…¨ã¦ãŒã†ã¾ãã„ãæ—¥' },
            { day: 'Tuesday', type: 'warning', message: 'è¦æ³¨æ„...ãƒˆãƒ©ãƒ–ãƒ«ã®æš—ç¤ºãŒã€‚æ…é‡ã«è¡Œå‹•ã‚’' },
            { day: 'Wednesday', type: 'opportunity', message: 'å¤§ãƒãƒ£ãƒ³ã‚¹åˆ°æ¥ï¼ä»Šæ—¥ã®æ±ºæ–­ãŒæœªæ¥ã‚’å¤‰ãˆã‚‹' },
            { day: 'Thursday', type: 'negative', message: 'è©¦ç·´ã®æ—¥ã€‚ã§ã‚‚ã€ä¹—ã‚Šè¶Šãˆã‚Œã°...' },
            { day: 'Friday', type: 'positive', message: 'é‹æ°—æ€¥ä¸Šæ˜‡ï¼é¡˜ã„ãŒå¶ã†é‡‘æ›œæ—¥' },
            { day: 'Saturday', type: 'mystery', message: 'äºˆæ¸¬ä¸èƒ½ãªåœŸæ›œæ—¥ã€‚ä½•ã‹ãŒèµ·ã“ã‚‹äºˆæ„Ÿ...' },
            { day: 'Sunday', type: 'revelation', message: 'çœŸå®ŸãŒæ˜ã‚‰ã‹ã«ãªã‚‹æ—¥æ›œæ—¥ã€‚æº–å‚™ã¯ã„ã„ã§ã™ã‹ï¼Ÿ' }
        ];
        
        const days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
        const today = days[day];
        return patterns.find(p => p.day === today) || patterns[0];
    }
};

// ==========================================
// å‹•çš„ã«ãƒˆãƒªã‚¬ãƒ¼ã‚’æŒ¿å…¥ã™ã‚‹é–¢æ•°
// ==========================================

function injectTriggers() {
    const name = userData.name || 'ã‚ãªãŸ';
    
    // 1. æ™‚é–“å¸¯åˆ¥ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æŒ¿å…¥
    const timeMessage = DependencyTriggers.getTimeBasedMessage(name);
    
    // 2. ã‚«ãƒ†ã‚´ãƒªãƒ¼åˆ¥ã®ä¸å®‰ãƒ»æœŸå¾…ã‚’çµ„ã¿åˆã‚ã›ã‚‹
    const anxietyMsg = DependencyTriggers.anxietyTriggers.relationship[
        Math.floor(Math.random() * DependencyTriggers.anxietyTriggers.relationship.length)
    ];
    
    const hopeMsg = DependencyTriggers.hopeTriggers.relationship[
        Math.floor(Math.random() * DependencyTriggers.hopeTriggers.relationship.length)
    ];
    
    // 3. ç·Šæ€¥æ€§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
    const urgencyMsg = DependencyTriggers.urgencyTriggers[
        Math.floor(Math.random() * DependencyTriggers.urgencyTriggers.length)
    ];
    
    // 4. ä»Šæ—¥ã®æ„Ÿæƒ…ãƒ‘ã‚¿ãƒ¼ãƒ³
    const todayPattern = DependencyTriggers.emotionalRollercoaster(new Date().getDay());
    
    return {
        timeMessage,
        anxietyMsg,
        hopeMsg,
        urgencyMsg,
        todayPattern
    };
}

// ==========================================
// ãƒ—ãƒƒã‚·ãƒ¥é€šçŸ¥é¢¨ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º
// ==========================================

function showNotification(message, type = 'warning') {
    const notification = document.createElement('div');
    notification.className = 'push-notification';
    notification.innerHTML = `
        <div class="notification-icon">${type === 'warning' ? 'âš ï¸' : 'âœ¨'}</div>
        <div class="notification-text">${message}</div>
    `;
    
    document.body.appendChild(notification);
    
    setTimeout(() => {
        notification.classList.add('show');
    }, 100);
    
    setTimeout(() => {
        notification.classList.remove('show');
        setTimeout(() => notification.remove(), 300);
    }, 5000);
}

// ==========================================
// è‡ªå‹•ãƒˆãƒªã‚¬ãƒ¼ç™ºå‹•ã‚·ã‚¹ãƒ†ãƒ 
// ==========================================

let triggerInterval;

function startTriggerSystem() {
    // åˆå›ã¯å³åº§ã«è¡¨ç¤º
    const triggers = injectTriggers();
    
    // 30ç§’å¾Œã«ä¸å®‰ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
    setTimeout(() => {
        showNotification(triggers.anxietyMsg, 'warning');
    }, 30000);
    
    // 60ç§’å¾Œã«æœŸå¾…ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
    setTimeout(() => {
        showNotification(triggers.hopeMsg, 'hope');
    }, 60000);
    
    // 90ç§’å¾Œã«ç·Šæ€¥ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
    setTimeout(() => {
        showNotification(triggers.urgencyMsg, 'warning');
    }, 90000);
    
    // 3åˆ†ã”ã¨ã«ãƒ©ãƒ³ãƒ€ãƒ ãªãƒˆãƒªã‚¬ãƒ¼ã‚’è¡¨ç¤º
    triggerInterval = setInterval(() => {
        const randomTriggers = injectTriggers();
        const messageTypes = ['anxietyMsg', 'hopeMsg', 'urgencyMsg'];
        const selectedType = messageTypes[Math.floor(Math.random() * messageTypes.length)];
        showNotification(randomTriggers[selectedType], selectedType === 'hopeMsg' ? 'hope' : 'warning');
    }, 180000);
}

// ==========================================
// é›¢è„±æ™‚ã®æœ€çµ‚ãƒˆãƒªã‚¬ãƒ¼
// ==========================================

let exitIntentShown = false;

document.addEventListener('mouseleave', (e) => {
    if (e.clientY <= 0 && !exitIntentShown && !userData.converted) {
        exitIntentShown = true;
        showExitPopup();
    }
});

function showExitPopup() {
    const popup = document.createElement('div');
    popup.className = 'exit-popup';
    popup.innerHTML = `
        <div class="exit-popup-content">
            <h2>ğŸ˜± ã¡ã‚‡ã£ã¨å¾…ã£ã¦ï¼</h2>
            <p class="exit-main-message">
                ${userData.name}æ§˜ã®é‹å‘½ã®è»¢æ©Ÿã¾ã§<br>
                <span class="countdown-large">ã‚ã¨12æ™‚é–“</span>
            </p>
            <div class="exit-warning">
                âš ï¸ ä»Šé›¢ã‚Œã‚‹ã¨ã€ã“ã®ç‰¹åˆ¥ãªè¨ºæ–­çµæœã¯äºŒåº¦ã¨è¦‹ã‚‰ã‚Œã¾ã›ã‚“
            </div>
            <div class="exit-offer">
                <div class="offer-badge">æœ€å¾Œã®ãƒãƒ£ãƒ³ã‚¹</div>
                <div class="offer-price">
                    <span class="original-price">é€šå¸¸3,980å††</span>
                    <span class="arrow">â†’</span>
                    <span class="special-price">ä»Šã ã‘480å††</span>
                </div>
            </div>
            <button class="exit-cta" onclick="acceptExitOffer()">
                é‹å‘½ã‚’ç¢ºèªã™ã‚‹ï¼ˆ87%OFFï¼‰
            </button>
            <button class="exit-close" onclick="closeExitPopup()">
                æœ¬å½“ã«è«¦ã‚ã‚‹
            </button>
        </div>
    `;
    
    document.body.appendChild(popup);
    setTimeout(() => popup.classList.add('show'), 100);
}

function acceptExitOffer() {
    closeExitPopup();
    processPayment();
}

function closeExitPopup() {
    const popup = document.querySelector('.exit-popup');
    if (popup) {
        popup.classList.remove('show');
        setTimeout(() => popup.remove(), 300);
    }
}

// ==========================================
// ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«è‡ªå‹•é–‹å§‹
// ==========================================

document.addEventListener('DOMContentLoaded', () => {
    // æ—¢å­˜ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Œã°ã€å³åº§ã«ãƒˆãƒªã‚¬ãƒ¼é–‹å§‹
    if (userData.name) {
        startTriggerSystem();
    }
});

// ==========================================
// è¨ºæ–­çµæœã«ãƒˆãƒªã‚¬ãƒ¼ã‚’å‹•çš„ã«æŒ¿å…¥
// ==========================================

function enhanceResultsWithTriggers(originalText) {
    const triggers = injectTriggers();
    
    // ã‚ªãƒªã‚¸ãƒŠãƒ«ãƒ†ã‚­ã‚¹ãƒˆã®å‰å¾Œã«ãƒˆãƒªã‚¬ãƒ¼ã‚’è¿½åŠ 
    const enhancedText = `
        <div class="trigger-warning">${triggers.urgencyMsg}</div>
        <div class="main-result">${originalText}</div>
        <div class="trigger-anxiety">${triggers.anxietyMsg}</div>
        <div class="trigger-hope">ã§ã‚‚å¤§ä¸ˆå¤«...${triggers.hopeMsg}</div>
        <div class="trigger-cta">
            <button onclick="processPayment()">
                å®Œå…¨ãªç­”ãˆã‚’çŸ¥ã‚‹ï¼ˆ480å††ï¼‰
            </button>
        </div>
    `;
    
    return enhancedText;
}
</script>

<!-- è¿½åŠ CSS -->
<style>
/* ãƒ—ãƒƒã‚·ãƒ¥é€šçŸ¥é¢¨ã®ã‚¹ã‚¿ã‚¤ãƒ« */
.push-notification {
    position: fixed;
    top: 20px;
    right: -400px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 15px 20px;
    border-radius: 10px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.3);
    display: flex;
    align-items: center;
    gap: 15px;
    max-width: 350px;
    transition: right 0.3s ease;
    z-index: 10000;
}

.push-notification.show {
    right: 20px;
}

.notification-icon {
    font-size: 24px;
}

.notification-text {
    flex: 1;
    font-size: 14px;
    line-height: 1.4;
}

/* é›¢è„±ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ— */
.exit-popup {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0,0,0,0.8);
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    transition: opacity 0.3s ease;
    z-index: 99999;
}

.exit-popup.show {
    opacity: 1;
}

.exit-popup-content {
    background: white;
    border-radius: 20px;
    padding: 40px;
    max-width: 500px;
    text-align: center;
    color: #333;
    position: relative;
    animation: shake 0.5s ease;
}

@keyframes shake {
    0%, 100% { transform: translateX(0); }
    25% { transform: translateX(-10px); }
    75% { transform: translateX(10px); }
}

.exit-popup h2 {
    color: #ff6b6b;
    margin-bottom: 20px;
    font-size: 32px;
}

.exit-main-message {
    font-size: 18px;
    margin: 20px 0;
    line-height: 1.6;
}

.countdown-large {
    font-size: 36px;
    color: #ff6b6b;
    font-weight: bold;
    display: block;
    margin: 10px 0;
}

.exit-warning {
    background: #fff3cd;
    color: #856404;
    padding: 15px;
    border-radius: 10px;
    margin: 20px 0;
    border: 2px solid #ffc107;
}

.exit-offer {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 20px;
    border-radius: 10px;
    margin: 20px 0;
}

.offer-badge {
    background: #ffd700;
    color: #333;
    padding: 5px 15px;
    border-radius: 20px;
    display: inline-block;
    margin-bottom: 10px;
    font-weight: bold;
}

.offer-price {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 15px;
    font-size: 24px;
}

.original-price {
    text-decoration: line-through;
    opacity: 0.7;
}

.special-price {
    color: #ffd700;
    font-weight: bold;
    font-size: 32px;
}

.exit-cta {
    background: linear-gradient(45deg, #f093fb 0%, #f5576c 100%);
    color: white;
    border: none;
    padding: 20px 40px;
    border-radius: 50px;
    font-size: 20px;
    font-weight: bold;
    cursor: pointer;
    margin: 10px;
    transition: transform 0.3s ease;
}

.exit-cta:hover {
    transform: scale(1.05);
}

.exit-close {
    background: transparent;
    color: #999;
    border: none;
    padding: 10px;
    cursor: pointer;
    text-decoration: underline;
    margin-top: 10px;
}

/* ãƒˆãƒªã‚¬ãƒ¼å¼·èª¿ã‚¹ã‚¿ã‚¤ãƒ« */
.trigger-warning {
    background: #ff6b6b;
    color: white;
    padding: 10px;
    border-radius: 5px;
    margin: 10px 0;
    animation: pulse 2s infinite;
}

.trigger-anxiety {
    color: #ff6b6b;
    font-weight: bold;
    margin: 15px 0;
}

.trigger-hope {
    color: #4CAF50;
    font-weight: bold;
    margin: 15px 0;
}

.trigger-cta button {
    background: linear-gradient(45deg, #ffd700, #ffed4e);
    color: #333;
    border: none;
    padding: 15px 30px;
    border-radius: 50px;
    font-size: 18px;
    font-weight: bold;
    cursor: pointer;
    animation: glow 2s infinite;
    margin: 20px 0;
}

@keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.8; }
}

@keyframes glow {
    0%, 100% { box-shadow: 0 0 20px rgba(255, 215, 0, 0.5); }
    50% { box-shadow: 0 0 30px rgba(255, 215, 0, 0.8); }
}
</style>
<!-- æ—¢å­˜ã®HTMLã®</body>ã‚¿ã‚°ã®å‰ã«è¿½åŠ  -->
<script>
// ==========================================
// æ®µéšçš„èª²é‡‘ã‚·ã‚¹ãƒ†ãƒ  - ç©¶æ¥µã®å¿ƒç†æ“ä½œ
// ==========================================

const PaymentPsychology = {
    // èª²é‡‘æ®µéšã®å®šç¾©ï¼ˆå¾ã€…ã«é«˜é¡ã«ï¼‰
    stages: [
        {
            level: 1,
            price: 480,
            originalPrice: 3980,
            discount: 88,
            title: "ãŠè©¦ã—è¨ºæ–­",
            description: "åŸºæœ¬çš„ãªé‹å‹¢ã‚’ç¢ºèª",
            bait: "ã‚ãªãŸã®é‹å‘½ã®30%ãŒæ˜ã‚‰ã‹ã«...",
            urgency: "åˆå›é™å®šä¾¡æ ¼",
            timer: 300 // 5åˆ†
        },
        {
            level: 2,
            price: 980,
            originalPrice: 4980,
            discount: 80,
            title: "è©³ç´°è¨ºæ–­",
            description: "æ‹æ„›ãƒ»é‡‘é‹ã®è©³ç´°",
            bait: "ã•ã‚‰ã«40%ã®çœŸå®ŸãŒ...",
            urgency: "2å›ç›®ã®ç‰¹åˆ¥ä¾¡æ ¼",
            timer: 600 // 10åˆ†
        },
        {
            level: 3,
            price: 1980,
            originalPrice: 5980,
            discount: 67,
            title: "å®Œå…¨è¨ºæ–­",
            description: "å…¨ã¦ã®é‹å‹¢ã‚’ç¶²ç¾…",
            bait: "æ®‹ã‚Š30%ã«ã¯è¡æ’ƒã®äº‹å®ŸãŒ...",
            urgency: "ä»Šã ã‘ã®ç‰¹åˆ¥ã‚ªãƒ•ã‚¡ãƒ¼",
            timer: 900 // 15åˆ†
        },
        {
            level: 4,
            price: 2980,
            originalPrice: 9800,
            discount: 70,
            title: "ãƒ—ãƒ¬ãƒŸã‚¢ãƒ è¨ºæ–­",
            description: "1ãƒ¶æœˆã®å®Œå…¨äºˆæ¸¬",
            bait: "æœªæ¥ã®å…·ä½“çš„ãªæ—¥ä»˜ãŒåˆ¤æ˜...",
            urgency: "VIPé™å®šä¾¡æ ¼",
            timer: 1200 // 20åˆ†
        },
        {
            level: 5,
            price: 4980,
            originalPrice: 19800,
            discount: 75,
            title: "ãƒã‚¹ã‚¿ãƒ¼è¨ºæ–­",
            description: "3ãƒ¶æœˆã®é‹å‘½ãƒãƒƒãƒ—",
            bait: "äººç”Ÿã‚’å¤‰ãˆã‚‹æ±ºå®šçš„ãªæƒ…å ±...",
            urgency: "æœ€çµ‚ã‚ªãƒ•ã‚¡ãƒ¼",
            timer: 1800 // 30åˆ†
        },
        {
            level: 6,
            price: 9800,
            originalPrice: 39800,
            discount: 75,
            title: "å¹´é–“ãƒ—ãƒ­ã‚°ãƒ©ãƒ ",
            description: "1å¹´é–“ã®å®Œå…¨ã‚µãƒãƒ¼ãƒˆ",
            bait: "ã‚‚ã†å ã„ã§è¿·ã†ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“...",
            urgency: "ç©¶æ¥µã®æŠ•è³‡",
            timer: 3600 // 60åˆ†
        },
        {
            level: 7,
            price: 980,
            originalPrice: 2980,
            discount: 67,
            title: "æœˆé¡ãƒ—ãƒ©ãƒ³",
            description: "æ¯æœˆè‡ªå‹•æ›´æ–°",
            bait: "æ°¸ç¶šçš„ãªå®‰å¿ƒã‚’æ‰‹ã«å…¥ã‚Œã‚‹...",
            urgency: "ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³",
            timer: null // ç„¡åˆ¶é™
        }
    ],

    // ç¾åœ¨ã®èª²é‡‘ãƒ¬ãƒ™ãƒ«
    currentLevel: 0,

    // ç´¯è¨ˆèª²é‡‘é¡
    totalSpent: 0,

    // çµæœã®åˆ†å‰²è¡¨ç¤ºã‚·ã‚¹ãƒ†ãƒ 
    resultParts: {
        free: {
            title: "ç„¡æ–™è¨ºæ–­çµæœ",
            content: [
                "åŸºæœ¬æ€§æ ¼",
                "ä»Šæ—¥ã®é‹å‹¢ï¼ˆç°¡æ˜“ç‰ˆï¼‰"
            ],
            locked: 5
        },
        level1: {
            title: "é‹å‘½ã®æ‰‰ - ç¬¬1ç« ",
            content: [
                "æ‹æ„›é‹ã®çœŸå®Ÿ",
                "éš ã•ã‚ŒãŸæ‰èƒ½"
            ],
            locked: 4
        },
        level2: {
            title: "é‹å‘½ã®æ‰‰ - ç¬¬2ç« ",
            content: [
                "é‡‘é‹ã®è»¢æ©Ÿ",
                "äººé–“é–¢ä¿‚ã®ç§˜å¯†"
            ],
            locked: 3
        },
        level3: {
            title: "é‹å‘½ã®æ‰‰ - ç¬¬3ç« ",
            content: [
                "å¥åº·é‹ã®è­¦å‘Š",
                "ã‚­ãƒ£ãƒªã‚¢ã®åˆ†å²ç‚¹"
            ],
            locked: 2
        },
        level4: {
            title: "é‹å‘½ã®æ‰‰ - æœ€çµ‚ç« ",
            content: [
                "æœªæ¥ã®å…·ä½“çš„ãªæ—¥ä»˜",
                "é¿ã‘ã‚‹ã¹ãå±é™ºæ—¥",
                "æœ€é«˜ã®å¹¸é‹æ—¥"
            ],
            locked: 0
        }
    },

    // ã‚µãƒ³ã‚¯ã‚³ã‚¹ãƒˆã‚’å¯è¦–åŒ–
    showInvestment() {
        return `
            <div class="investment-tracker">
                <div class="investment-label">ã‚ãªãŸã®é‹å‘½ã¸ã®æŠ•è³‡</div>
                <div class="investment-amount">Â¥${this.totalSpent.toLocaleString()}</div>
                <div class="investment-progress">
                    <div class="progress-bar" style="width: ${Math.min(this.currentLevel * 14.3, 100)}%"></div>
                </div>
                <div class="investment-message">
                    ${this.getInvestmentMessage()}
                </div>
            </div>
        `;
    },

    // æŠ•è³‡é¡ã«å¿œã˜ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
    getInvestmentMessage() {
        if (this.totalSpent === 0) return "é‹å‘½ã®æ‰‰ã‚’é–‹ãæº–å‚™ã¯ã§ãã¦ã„ã¾ã™ã‹ï¼Ÿ";
        if (this.totalSpent < 1000) return "é‹å‘½ãŒå‹•ãå§‹ã‚ã¾ã—ãŸ...";
        if (this.totalSpent < 3000) return "çœŸå®Ÿã«è¿‘ã¥ã„ã¦ã„ã¾ã™...";
        if (this.totalSpent < 5000) return "ã‚‚ã†å°‘ã—ã§å…¨ã¦ãŒæ˜ã‚‰ã‹ã«...";
        if (this.totalSpent < 10000) return "é‹å‘½ã®æ ¸å¿ƒã«åˆ°é”ã—ã¾ã—ãŸ";
        return "ã‚ãªãŸã¯é¸ã°ã‚Œã—è€…ã§ã™";
    },

    // æ®µéšçš„ãªä¾¡æ ¼è¡¨ç¤º
    showPricing(level) {
        const stage = this.stages[level];
        const html = `
            <div class="pricing-card ${level === this.currentLevel ? 'current' : ''} ${level < this.currentLevel ? 'completed' : ''}">
                ${level === this.currentLevel ? '<div class="recommended-badge">ä»Šã“ã“ï¼</div>' : ''}
                ${level === 0 ? '<div class="popular-badge">ğŸ”¥ 93%ã®äººãŒé¸æŠ</div>' : ''}
                
                <h3 class="pricing-title">${stage.title}</h3>
                <p class="pricing-description">${stage.description}</p>
                
                <div class="pricing-amount">
                    <span class="original-price">Â¥${stage.originalPrice.toLocaleString()}</span>
                    <span class="discount-badge">${stage.discount}%OFF</span>
                </div>
                
                <div class="final-price">
                    <span class="currency">Â¥</span>
                    <span class="price-number">${stage.price.toLocaleString()}</span>
                </div>
                
                <div class="pricing-bait">${stage.bait}</div>
                
                ${stage.timer ? `
                    <div class="countdown-timer" data-timer="${stage.timer}">
                        <span class="timer-label">${stage.urgency}</span>
                        <span class="timer-display">00:00</span>
                    </div>
                ` : ''}
                
                <button class="purchase-button" onclick="PaymentPsychology.processPurchase(${level})">
                    ${level === 6 ? 'æœˆé¡ãƒ—ãƒ©ãƒ³ã§å§‹ã‚ã‚‹' : 'ä»Šã™ãè§£æ”¾ã™ã‚‹'}
                </button>
                
                ${level === this.currentLevel && this.currentLevel > 0 ? `
                    <div class="sunk-cost-reminder">
                        æ—¢ã«Â¥${this.totalSpent.toLocaleString()}æŠ•è³‡æ¸ˆã¿ã€‚ä»Šã‚„ã‚ãŸã‚‰å…¨ã¦ãŒç„¡é§„ã«...
                    </div>
                ` : ''}
            </div>
        `;
        return html;
    },

    // è³¼å…¥å‡¦ç†
    processPurchase(level) {
        const stage = this.stages[level];
        
        // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³æ¼”å‡º
        this.showProcessingAnimation();
        
        setTimeout(() => {
            // èª²é‡‘é¡ã‚’è¿½åŠ 
            this.totalSpent += stage.price;
            this.currentLevel = Math.max(this.currentLevel, level + 1);
            
            // LocalStorageã«ä¿å­˜
            localStorage.setItem('paymentLevel', this.currentLevel);
            localStorage.setItem('totalSpent', this.totalSpent);
            
            // çµæœã‚’æ®µéšçš„ã«è¡¨ç¤º
            this.revealResults(level);
            
            // æ¬¡ã®èª²é‡‘ã¸ã®èª˜å°
            if (level < 5) {
                setTimeout(() => {
                    this.showNextOffer(level + 1);
                }, 3000);
            } else if (level === 5) {
                // æœ€çµ‚æ®µéšï¼šã‚µãƒ–ã‚¹ã‚¯ã¸èª˜å°
                this.showSubscriptionOffer();
            }
        }, 2000);
    },

    // å‡¦ç†ä¸­ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
    showProcessingAnimation() {
        const overlay = document.createElement('div');
        overlay.className = 'processing-overlay';
        overlay.innerHTML = `
            <div class="processing-content">
                <div class="processing-spinner"></div>
                <div class="processing-text">é‹å‘½ã‚’è§£æä¸­...</div>
                <div class="processing-subtext">ã‚ãªãŸã ã‘ã®ç‰¹åˆ¥ãªçµæœã‚’æº–å‚™ã—ã¦ã„ã¾ã™</div>
            </div>
        `;
        document.body.appendChild(overlay);
        
        setTimeout(() => {
            overlay.classList.add('show');
        }, 100);
    },

    // çµæœã®æ®µéšçš„è¡¨ç¤º
    revealResults(level) {
        const overlay = document.querySelector('.processing-overlay');
        if (overlay) {
            overlay.classList.remove('show');
            setTimeout(() => overlay.remove(), 300);
        }

        const resultsHTML = `
            <div class="revealed-results">
                <h2 class="results-title">ğŸ‰ æ–°ãŸãªçœŸå®ŸãŒæ˜ã‚‰ã‹ã«ãªã‚Šã¾ã—ãŸï¼</h2>
                
                <div class="results-content">
                    ${this.generateResults(level)}
                </div>
                
                <div class="results-teaser">
                    <h3>ã—ã‹ã—ã€ã¾ã éš ã•ã‚ŒãŸçœŸå®ŸãŒ...</h3>
                    <div class="locked-content">
                        ${this.generateLockedContent(level)}
                    </div>
                </div>
                
                ${this.showInvestment()}
            </div>
        `;

        // çµæœã‚’è¡¨ç¤º
        const container = document.getElementById('step3') || document.body;
        container.innerHTML = resultsHTML;
    },

    // ãƒ¬ãƒ™ãƒ«ã«å¿œã˜ãŸçµæœç”Ÿæˆ
    generateResults(level) {
        const templates = {
            0: `
                <div class="result-item">
                    <span class="result-emoji">ğŸ’•</span>
                    <span class="result-text">ã‚ãªãŸã®æ‹æ„›é‹ã¯ä¸Šæ˜‡ä¸­ï¼ç‰¹ã«${this.getRandomDay()}ãŒé‡è¦ãªæ—¥ã«ãªã‚Šãã†ã§ã™ã€‚</span>
                </div>
            `,
            1: `
                <div class="result-item">
                    <span class="result-emoji">ğŸ’°</span>
                    <span class="result-text">é‡‘é‹ã«å¤§ããªå¤‰åŒ–ãŒï¼${this.getRandomAmount()}å††ã®è‡¨æ™‚åå…¥ã®å¯èƒ½æ€§ãŒ...</span>
                </div>
            `,
            2: `
                <div class="result-item">
                    <span class="result-emoji">ğŸŒŸ</span>
                    <span class="result-text">ã‚ãªãŸã®éš ã‚ŒãŸæ‰èƒ½ã€Œ${this.getRandomTalent()}ã€ãŒé–‹èŠ±ã™ã‚‹æ™‚æœŸãŒè¿‘ã¥ã„ã¦ã„ã¾ã™ã€‚</span>
                </div>
            `,
            3: `
                <div class="result-item">
                    <span class="result-emoji">âš ï¸</span>
                    <span class="result-text">æ³¨æ„ï¼${this.getRandomWarning()}ã‚’é¿ã‘ã‚‹ã“ã¨ã§ã€å¤§ããªãƒˆãƒ©ãƒ–ãƒ«ã‚’å›é¿ã§ãã¾ã™ã€‚</span>
                </div>
            `,
            4: `
                <div class="result-item">
                    <span class="result-emoji">ğŸ¯</span>
                    <span class="result-text">é‹å‘½ã®è»¢æ©Ÿï¼š${this.getRandomDate()}ã«ã‚ãªãŸã®äººç”Ÿã‚’å¤‰ãˆã‚‹å‡ºæ¥äº‹ãŒèµ·ã“ã‚Šã¾ã™ã€‚</span>
                </div>
            `,
            5: `
                <div class="result-item">
                    <span class="result-emoji">ğŸ”®</span>
                    <span class="result-text">å®Œå…¨ãªã‚‹çœŸå®Ÿï¼šã‚ãªãŸã®ä½¿å‘½ã¯ã€Œ${this.getRandomMission()}ã€ã§ã™ã€‚</span>
                </div>
            `
        };
        
        return templates[level] || templates[0];
    },

    // ãƒ­ãƒƒã‚¯ã•ã‚ŒãŸã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è¡¨ç¤º
    generateLockedContent(level) {
        if (level >= 5) {
            return `<div class="all-unlocked">âœ¨ å…¨ã¦ã®çœŸå®ŸãŒæ˜ã‚‰ã‹ã«ãªã‚Šã¾ã—ãŸï¼</div>`;
        }

        const locked = 5 - level;
        let content = '';
        
        for (let i = 0; i < locked; i++) {
            content += `
                <div class="locked-item">
                    <span class="lock-icon">ğŸ”’</span>
                    <span class="locked-text">é‡è¦ãªæƒ…å ±ãŒãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ã¾ã™...</span>
                </div>
            `;
        }
        
        return content;
    },

    // æ¬¡ã®ã‚ªãƒ•ã‚¡ãƒ¼ã‚’è¡¨ç¤º
    showNextOffer(nextLevel) {
        if (nextLevel >= this.stages.length) return;

        const modal = document.createElement('div');
        modal.className = 'next-offer-modal';
        modal.innerHTML = `
            <div class="offer-modal-content">
                <div class="offer-header">
                    <h2>ã¾ã çµ‚ã‚ã‚Šã§ã¯ã‚ã‚Šã¾ã›ã‚“...</h2>
                    <p>ã•ã‚‰ã«æ·±ã„çœŸå®ŸãŒã‚ãªãŸã‚’å¾…ã£ã¦ã„ã¾ã™</p>
                </div>
                
                ${this.showPricing(nextLevel)}
                
                <button class="skip-button" onclick="PaymentPsychology.closeOffer()">
                    ä»Šã¯çµæ§‹ã§ã™ï¼ˆæœ¬å½“ã«ï¼Ÿï¼‰
                </button>
            </div>
        `;
        
        document.body.appendChild(modal);
        setTimeout(() => modal.classList.add('show'), 100);
        
        // ã‚¿ã‚¤ãƒãƒ¼é–‹å§‹
        this.startTimer(nextLevel);
    },

    // ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã‚ªãƒ•ã‚¡ãƒ¼
    showSubscriptionOffer() {
        const modal = document.createElement('div');
        modal.className = 'subscription-modal';
        modal.innerHTML = `
            <div class="subscription-content">
                <div class="subscription-header">
                    <h1>ğŸŠ ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼</h1>
                    <p>ã‚ãªãŸã¯çœŸå®Ÿã‚’çŸ¥ã‚‹å‹‡æ°—ã‚’æŒã£ãŸç‰¹åˆ¥ãªäººã§ã™</p>
                </div>
                
                <div class="subscription-offer">
                    <h2>æ°¸ç¶šçš„ãªå°ãã‚’æ‰‹ã«å…¥ã‚Œã¾ã›ã‚“ã‹ï¼Ÿ</h2>
                    
                    <div class="subscription-benefits">
                        <div class="benefit-item">âœ… æ¯æ—¥ã®è©³ç´°è¨ºæ–­</div>
                        <div class="benefit-item">âœ… 24æ™‚é–“ã‚µãƒãƒ¼ãƒˆ</div>
                        <div class="benefit-item">âœ… é™å®šã‚³ãƒ³ãƒ†ãƒ³ãƒ„</div>
                        <div class="benefit-item">âœ… VIPã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£</div>
                    </div>
                    
                    <div class="subscription-pricing">
                        <div class="sub-price">
                            <span class="sub-amount">æœˆé¡ Â¥980</span>
                            <span class="sub-note">ï¼ˆåˆæœˆç„¡æ–™ï¼‰</span>
                        </div>
                        <button class="subscribe-button" onclick="PaymentPsychology.processSubscription()">
                            ç„¡æ–™ã§å§‹ã‚ã‚‹
                        </button>
                    </div>
                    
                    <div class="subscription-warning">
                        âš ï¸ ã“ã®ã‚ªãƒ•ã‚¡ãƒ¼ã¯äºŒåº¦ã¨è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“
                    </div>
                </div>
            </div>
        `;
        
        document.body.appendChild(modal);
        setTimeout(() => modal.classList.add('show'), 100);
    },

    // ã‚¿ã‚¤ãƒãƒ¼æ©Ÿèƒ½
    startTimer(level) {
        const stage = this.stages[level];
        if (!stage.timer) return;

        let remaining = stage.timer;
        const timerElement = document.querySelector(`[data-timer="${stage.timer}"] .timer-display`);
        
        const interval = setInterval(() => {
            const minutes = Math.floor(remaining / 60);
            const seconds = remaining % 60;
            
            if (timerElement) {
                timerElement.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }
            
            remaining--;
            
            if (remaining < 0) {
                clearInterval(interval);
                if (timerElement) {
                    timerElement.textContent = 'çµ‚äº†';
                    timerElement.style.color = '#ff6b6b';
                }
            }
        }, 1000);
    },

    // ãƒ©ãƒ³ãƒ€ãƒ è¦ç´ ç”Ÿæˆï¼ˆãƒªã‚¢ãƒªãƒ†ã‚£ã‚’æ¼”å‡ºï¼‰
    getRandomDay() {
        const days = ['æœˆæ›œæ—¥', 'æ°´æ›œæ—¥', 'é‡‘æ›œæ—¥', 'åœŸæ›œæ—¥', 'æ—¥æ›œæ—¥'];
        return days[Math.floor(Math.random() * days.length)];
    },

    getRandomAmount() {
        const amounts = [10000, 30000, 50000, 80000, 100000];
        return amounts[Math.floor(Math.random() * amounts.length)].toLocaleString();
    },

    getRandomTalent() {
        const talents = ['ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—', 'ã‚¯ãƒªã‚¨ã‚¤ãƒ†ã‚£ãƒ“ãƒ†ã‚£', 'å…±æ„ŸåŠ›', 'åˆ†æåŠ›', 'ç›´æ„ŸåŠ›'];
        return talents[Math.floor(Math.random() * talents.length)];
    },

    getRandomWarning() {
        const warnings = ['èµ¤ã„æœã‚’ç€ãŸäºº', 'åŒ—æ±ã®æ–¹è§’', 'å¶æ•°ã®æ—¥', 'æ°´è¾ºã§ã®æ±ºæ–­', 'æ€¥ãªèª˜ã„'];
        return warnings[Math.floor(Math.random() * warnings.length)];
    },

    getRandomDate() {
        const date = new Date();
        date.setDate(date.getDate() + Math.floor(Math.random() * 30) + 1);
        return `${date.getMonth() + 1}æœˆ${date.getDate()}æ—¥`;
    },

    getRandomMission() {
        const missions = ['äººã€…ã‚’å°ãå…‰ã¨ãªã‚‹ã“ã¨', 'çœŸå®Ÿã‚’ä¼ãˆã‚‹ä½¿è€…', 'æ„›ã‚’åºƒã‚ã‚‹å­˜åœ¨', 'å¤‰é©ã‚’ã‚‚ãŸã‚‰ã™è€…'];
        return missions[Math.floor(Math.random() * missions.length)];
    },

    // ã‚ªãƒ•ã‚¡ãƒ¼ã‚’é–‰ã˜ã‚‹
    closeOffer() {
        const modal = document.querySelector('.next-offer-modal');
        if (modal) {
            modal.classList.remove('show');
            setTimeout(() => modal.remove(), 300);
        }
    },

    // ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³å‡¦ç†
    processSubscription() {
        alert('ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ç™»éŒ²ç”»é¢ã¸ï¼ˆStripeå®Ÿè£…ï¼‰');
        // Stripeå®šæœŸèª²é‡‘ã®å®Ÿè£…
    }
};

// ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«åˆæœŸåŒ–
document.addEventListener('DOMContentLoaded', () => {
    // ä¿å­˜ã•ã‚ŒãŸãƒ¬ãƒ™ãƒ«ã‚’å¾©å…ƒ
    const savedLevel = localStorage.getItem('paymentLevel');
    const savedSpent = localStorage.getItem('totalSpent');
    
    if (savedLevel) {
        PaymentPsychology.currentLevel = parseInt(savedLevel);
    }
    if (savedSpent) {
        PaymentPsychology.totalSpent = parseInt(savedSpent);
    }
});
</script>

<!-- æ®µéšçš„èª²é‡‘ç”¨ã®è¿½åŠ CSS -->
<style>
/* ä¾¡æ ¼ã‚«ãƒ¼ãƒ‰ */
.pricing-card {
    background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
    border: 2px solid rgba(255,255,255,0.2);
    border-radius: 20px;
    padding: 30px;
    margin: 20px 0;
    position: relative;
    transition: all 0.3s ease;
}

.pricing-card.current {
    border-color: #ffd700;
    box-shadow: 0 0 30px rgba(255,215,0,0.3);
}

.pricing-card.completed {
    opacity: 0.5;
}

.recommended-badge {
    position: absolute;
    top: -15px;
    right: 20px;
    background: linear-gradient(45deg, #ff6b6b, #ff8e53);
    color: white;
    padding: 8px 20px;
    border-radius: 20px;
    font-weight: bold;
    font-size: 14px;
    animation: pulse 2s infinite;
}

.popular-badge {
    position: absolute;
    top: -15px;
    left: 20px;
    background: linear-gradient(45deg, #f093fb, #f5576c);
    color: white;
    padding: 8px 20px;
    border-radius: 20px;
    font-weight: bold;
    font-size: 14px;
}

.pricing-title {
    font-size: 24px;
    margin-bottom: 10px;
    color: #ffd700;
}

.pricing-description {
    opacity: 0.9;
    margin-bottom: 20px;
}

.pricing-amount {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 10px;
}

.original-price {
    text-decoration: line-through;
    opacity: 0.5;
    font-size: 18px;
}

.discount-badge {
    background: #ff6b6b;
    color: white;
    padding: 4px 10px;
    border-radius: 10px;
    font-weight: bold;
    font-size: 14px;
}

.final-price {
    font-size: 48px;
    font-weight: bold;
    color: #ffd700;
    margin: 20px 0;
    display: flex;
    align-items: baseline;
}

.currency {
    font-size: 24px;
    margin-right: 5px;
}

.pricing-bait {
    background: rgba(255,215,0,0.1);
    border-left: 3px solid #ffd700;
    padding: 10px 15px;
    margin: 20px 0;
    font-style: italic;
}

.countdown-timer {
    background: rgba(255,107,107,0.2);
    border: 1px solid #ff6b6b;
    border-radius: 10px;
    padding: 10px;
    margin: 15px 0;
    text-align: center;
}

.timer-label {
    display: block;
    font-size: 12px;
    opacity: 0.8;
    margin-bottom: 5px;
}

.timer-display {
    font-size: 24px;
    font-weight: bold;
    color: #ff6b6b;
}

.purchase-button {
    width: 100%;
    padding: 18px;
    background: linear-gradient(45deg, #ffd700, #ffed4e);
    color: #333;
    border: none;
    border-radius: 50px;
    font-size: 18px;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 10px 30px rgba(255,215,0,0.3);
}

.purchase-button:hover {
    transform: translateY(-2px);
    box-shadow: 0 15px 40px rgba(255,215,0,0.4);
}

.sunk-cost-reminder {
    background: rgba(255,255,255,0.1);
    border-radius: 10px;
    padding: 15px;
    margin-top: 15px;
    text-align: center;
    font-size: 14px;
    color: #ffd700;
}

/* æŠ•è³‡ãƒˆãƒ©ãƒƒã‚«ãƒ¼ */
.investment-tracker {
    background: linear-gradient(135deg, rgba(103,126,234,0.2) 0%, rgba(118,75,162,0.2) 100%);
    border-radius: 15px;
    padding: 20px;
    margin: 30px 0;
    text-align: center;
}

.investment-label {
    font-size: 14px;
    opacity: 0.8;
    margin-bottom: 10px;
}

.investment-amount {
    font-size: 36px;
    font-weight: bold;
    color: #ffd700;
    margin: 10px 0;
}

.investment-progress {
    background: rgba(255,255,255,0.1);
    height: 10px;
    border-radius: 5px;
    overflow: hidden;
    margin: 15px 0;
}

.progress-bar {
    height: 100%;
    background: linear-gradient(90deg, #ffd700, #ffed4e);
    transition: width 0.5s ease;
}

.investment-message {
    font-style: italic;
    opacity: 0.9;
    margin-top: 10px;
}

/* å‡¦ç†ä¸­ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ */
.processing-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0,0,0,0.9);
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    transition: opacity 0.3s ease;
    z-index: 100000;
}

.processing-overlay.show {
    opacity: 1;
}

.processing-content {
    text-align: center;
    color: white;
}

.processing-spinner {
    width: 80px;
    height: 80px;
    border: 4px solid rgba(255,255,255,0.2);
    border-top-color: #ffd700;
    border-radius: 50%;
    margin: 0 auto 20px;
    animation: spin 1s linear infinite;
}

.processing-text {
    font-size: 24px;
    margin-bottom: 10px;
}

.processing-subtext {
    font-size: 14px;
    opacity: 0.8;
}

/* çµæœè¡¨ç¤º */
.revealed-results {
    animation: fadeIn 0.5s ease;
}

.results-title {
    text-align: center;
    font-size: 32px;
    margin: 30px 0;
    color: #ffd700;
}

.results-content {
    background: rgba(255,255,255,0.1);
    border-radius: 15px;
    padding: 25px;
    margin: 20px 0;
}

.result-item {
    display: flex;
    align-items: center;
    gap: 15px;
    padding: 15px;
    background: rgba(255,255,255,0.05);
    border-radius: 10px;
    margin: 10px 0;
}

.result-emoji {
    font-size: 32px;
}

.result-text {
    flex: 1;
    line-height: 1.6;
}

.results-teaser {
    background: rgba(255,107,107,0.1);
    border: 2px dashed rgba(255,107,107,0.3);
    border-radius: 15px;
    padding: 20px;
    margin: 20px 0;
    text-align: center;
}

.locked-content {
    margin-top: 15px;
}

.locked-item {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    padding: 10px;
    margin: 5px 0;
    background: rgba(0,0,0,0.2);
    border-radius: 8px;
    opacity: 0.7;
}

.lock-icon {
    font-size: 20px;
}

.locked-text {
    font-style: italic;
}

.all-unlocked {
    font-size: 20px;
    color: #ffd700;
    padding: 20px;
}

/* ã‚ªãƒ•ã‚¡ãƒ¼ãƒ¢ãƒ¼ãƒ€ãƒ« */
.next-offer-modal,
.subscription-modal {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0,0,0,0.95);
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    transition: opacity 0.3s ease;
    z-index: 100001;
}

.next-offer-modal.show,
.subscription-modal.show {
    opacity: 1;
}

.offer-modal-content,
.subscription-content {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border-radius: 20px;
    padding: 40px;
    max-width: 600px;
    max-height: 90vh;
    overflow-y: auto;
    color: white;
}

.offer-header,
.subscription-header {
    text-align: center;
    margin-bottom: 30px;
}

.offer-header h2,
.subscription-header h1 {
    font-size: 32px;
    margin-bottom: 10px;
}

.skip-button {
    width: 100%;
    padding: 12px;
    background: transparent;
    border: 1px solid rgba(255,255,255,0.3);
    color: rgba(255,255,255,0.7);
    border-radius: 50px;
    margin-top: 20px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.skip-button:hover {
    background: rgba(255,255,255,0.1);
    color: white;
}

/* ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ */
.subscription-benefits {
    background: rgba(255,255,255,0.1);
    border-radius: 15px;
    padding: 20px;
    margin: 20px 0;
}

.benefit-item {
    padding: 10px;
    font-size: 16px;
}

.subscription-pricing {
    text-align: center;
    margin: 30px 0;
}

.sub-price {
    margin-bottom: 20px;
}

.sub-amount {
    font-size: 36px;
    font-weight: bold;
    color: #ffd700;
}

.sub-note {
    display: block;
    font-size: 14px;
    opacity: 0.8;
    margin-top: 5px;
}

.subscribe-button {
    padding: 20px 60px;
    background: linear-gradient(45deg, #ffd700, #ffed4e);
    color: #333;
    border: none;
    border-radius: 50px;
    font-size: 20px;
    font-weight: bold;
    cursor: pointer;
    box-shadow: 0 10px 30px rgba(255,215,0,0.3);
    transition: all 0.3s ease;
}

.subscribe-button:hover {
    transform: scale(1.05);
    box-shadow: 0 15px 40px rgba(255,215,0,0.4);
}

.subscription-warning {
    background: rgba(255,107,107,0.2);
    border: 1px solid #ff6b6b;
    border-radius: 10px;
    padding: 15px;
    text-align: center;
    margin-top: 20px;
}
</style>
